<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-10-10 Thu 12:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Introduction to FIJI - workflows v. 1.9</title>
<meta name="author" content="Federico Gasparoli, Szymon Stoma Simon F. Nørrelykke" />
<meta name="keywords" content="fiji, imagej, teaching" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Introduction to FIJI - workflows v. 1.9</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgddea1de">1. working with single channel images</a>
<ul>
<li><a href="#orgc35e105">1.1. opening the image and basic info</a></li>
<li><a href="#orgf6b700f">1.2. opening the image and basic drawing</a></li>
<li><a href="#orgb05d131">1.3. image inspection</a></li>
<li><a href="#org31c8d7e">1.4. adjust brightness/contrast of all open images</a></li>
<li><a href="#org926ae07">1.5. copy pasting from image to image</a></li>
<li><a href="#orgaff212a">1.6. file handling and non-invasive editing</a></li>
<li><a href="#org9480016">1.7. file handling and invasive editing</a></li>
<li><a href="#org5f4be3c">1.8. LUT and calibration bar</a></li>
<li><a href="#orgf822c40">1.9. 8-bit and 16-bit pseudocolor images</a></li>
<li><a href="#orge39fc93">1.10. pseudocolor image to RGB conversion</a></li>
<li><a href="#org8ad7e62">1.11. color spaces</a></li>
<li><a href="#org2124601">1.12. line-tool operations</a></li>
<li><a href="#org74ecc09">1.13. histogram based intensity transformations</a></li>
<li><a href="#orgce82828">1.14. histogram adjustments</a></li>
<li><a href="#orgb03ff17">1.15. using 16 bit images to increase precision</a></li>
</ul>
</li>
<li><a href="#org1f69b20">2. working with multichannel images</a>
<ul>
<li><a href="#org89830a1">2.1. create new image</a></li>
<li><a href="#org7be33ca">2.2. composite images - splitting and merging</a></li>
<li><a href="#org4d3c946">2.3. composite images - individual channel corrections</a></li>
<li><a href="#org6dd7202">2.4. microscopy stacks handling</a></li>
</ul>
</li>
<li><a href="#orgd764406">3. image processing: thresholding &amp; filters</a>
<ul>
<li><a href="#orga47fa47">3.1. basic concept of thresholding</a></li>
<li><a href="#org19337d5">3.2. basic concept of filtering: binary filters</a></li>
<li><a href="#org54adf9e">3.3. basic concept of filters: sharpen</a></li>
<li><a href="#orgb89e783">3.4. edge filters - vertical stripes</a></li>
<li><a href="#org2811360">3.5. edge filters - horizontal stripes</a></li>
<li><a href="#org600a190">3.6. edge filters - checkerboard</a></li>
<li><a href="#org41c3a9e">3.7. Morphological filters - Binary</a></li>
<li><a href="#orgd24d16c">3.8. Morphological filters - Gray</a></li>
<li><a href="#org9999e2a">3.9. basics mathematical operations on single image</a></li>
<li><a href="#org5df77ed">3.10. beyond the limits of bits</a></li>
<li><a href="#org7da8a8f">3.11. basics mathematical operations on two images</a></li>
<li><a href="#org38541d3">3.12. seeing JPEG artifacts</a></li>
</ul>
</li>
<li><a href="#orgb2f8a03">4. background elimination</a>
<ul>
<li><a href="#orgb7cf73b">4.1. dividing by background image</a></li>
<li><a href="#org63bceb5">4.2. background elimination - flat field correction</a></li>
<li><a href="#org0d571cb">4.3. background elimination - flat field correction using Image calculator</a></li>
</ul>
</li>
<li><a href="#org89b5d08">5. manual measurements and working with rois</a>
<ul>
<li><a href="#org35f9030">5.1. measuring fluorescence within a selection</a></li>
<li><a href="#org26ac749">5.2. measuring geometrical properties in the image</a></li>
</ul>
</li>
<li><a href="#orgce806f8">6. automatic measurements</a>
<ul>
<li><a href="#org97b0ebe">6.1. identifying and measuring objects - basics</a></li>
<li><a href="#org07409a8">6.2. identifying and measuring objects - cells #1</a></li>
<li><a href="#org1c5d126">6.3. identifying and measuring objects - cells #2</a></li>
</ul>
</li>
<li><a href="#org146e470">7. Segmentation</a>
<ul>
<li><a href="#org8f837f0">7.1. DAPI segmentation with thresholding</a></li>
<li><a href="#orgdb06b3a">7.2. DAPI segmentation with filters and thresholding</a></li>
<li><a href="#org0685c02">7.3. DAPI segmentation with Weka</a></li>
<li><a href="#orgd9cfcc5">7.4. DAPI double-segmentation with Weka</a></li>
<li><a href="#orgd360039">7.5. DAPI segmentation with StarDist</a></li>
<li><a href="#org17d2ca8">7.6. H&amp;E segmentation with StarDist</a></li>
</ul>
</li>
<li><a href="#org879d61f">8. Spot detection</a>
<ul>
<li><a href="#orgb0ae0bb">8.1. manual spot detection with the Multi-point Tool (IJ:19.6)</a></li>
<li><a href="#orgff1f04a">8.2. algorithmic spot detection with Find Maxima (IJ:29.4)</a></li>
<li><a href="#org3bfa7b5">8.3. automatic spot segmentation with thresholding</a></li>
<li><a href="#org36747c7">8.4. spot detection with noise</a></li>
<li><a href="#org623ed14">8.5. spot detection with variable background</a></li>
</ul>
</li>
<li><a href="#orgfb3bb5c">9. scripting / macros / automation basics</a>
<ul>
<li><a href="#orgf40d009">9.1. macro recorder - reproducing edits</a></li>
<li><a href="#org7dc3578">9.2. macro recorder - repeating actions on stack</a></li>
<li><a href="#org0cfb643">9.3. automatic iteration</a></li>
<li><a href="#orgcee3c93">9.4. automatic iteration - introducing function for stop condition</a></li>
<li><a href="#org6152501">9.5. adding macro to the menu</a></li>
<li><a href="#org82a8b23">9.6. iterations and variables in the macro: multi-measurement</a></li>
<li><a href="#org85d88ae">9.7. automatic measurement and saving to a file</a></li>
<li><a href="#org80b188c">9.8. user input via GUI</a></li>
<li><a href="#org45547ae">9.9. user input via image window / selection</a></li>
<li><a href="#orgbc9d3ef">9.10. batch mode - basics</a></li>
<li><a href="#org3acfa62">9.11. batch mode - full control on processing files</a></li>
</ul>
</li>
<li><a href="#org8af8c38">10. workflow: tracking</a>
<ul>
<li><a href="#org7835065">10.1. create image with moving dots</a></li>
<li><a href="#org9c521ac">10.2. tracking: process single image</a></li>
<li><a href="#org3f49755">10.3. tracking: process whole stack</a></li>
<li><a href="#orgc45a7b6">10.4. tracking: process whole stack - enabling linking of the objects</a></li>
</ul>
</li>
<li><a href="#orgf179bfb">11. workflow: FRET</a>
<ul>
<li><a href="#org8cd43b5">11.1. preparation part 1 - image import</a></li>
<li><a href="#org960a507">11.2. preparation part 2 - averaging</a></li>
<li><a href="#org1c3915d">11.3. preparation part 3 - masks</a></li>
<li><a href="#orgf1a7371">11.4. preparation part 4 - ratios</a></li>
<li><a href="#orgcc291f9">11.5. analysis - problem: cell population</a></li>
<li><a href="#org7724b42">11.6. preparation part 5 - cropping</a></li>
<li><a href="#org8bdd96b">11.7. analysis - problem: chromatin change</a></li>
<li><a href="#org0a2ab5b">11.8. analysis - problem: manual labor</a></li>
</ul>
</li>
<li><a href="#orga8efc58">12. workflow: scratch assay</a>
<ul>
<li><a href="#orgfd372ba">12.1. part 1</a></li>
<li><a href="#org4a2c380">12.2. part 2</a></li>
<li><a href="#org0500687">12.3. part 3</a></li>
</ul>
</li>
<li><a href="#org402ed38">13. various useful tools</a>
<ul>
<li><a href="#org469f4d6">13.1. installing plugins</a></li>
<li><a href="#org5673f0e">13.2. using line selection to make a &ldquo;straighten&rdquo; image</a></li>
<li><a href="#org6489141">13.3. using 3D viewer</a></li>
<li><a href="#org3f0c713">13.4. preparing images for publications</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgddea1de" class="outline-2">
<h2 id="orgddea1de"><span class="section-number-2">1.</span> working with single channel images</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgc35e105" class="outline-3">
<h3 id="orgc35e105"><span class="section-number-3">1.1.</span> opening the image and basic info</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li>file &gt; open samples &gt; HeLa (IJ:26.2)</li>
<li>image &gt; show info (ctrl-i) (IJ:28.3)</li>
<li>analyze &gt; tools &gt; scale bar (IJ:30.14.6)</li>
</ol>
</div>
</div>

<div id="outline-container-orgf6b700f" class="outline-3">
<h3 id="orgf6b700f"><span class="section-number-3">1.2.</span> opening the image and basic drawing</h3>
<div class="outline-text-3" id="text-1-2">
<ol class="org-ol">
<li><b>target:</b> &ldquo;convert&rdquo; [geometry-source.tif] into [geometry-target.tif]</li>
<li>file &gt; open : [geometry-source.tif] (IJ:26.2)</li>
<li>use following tools to convert source into target:
<ol class="org-ol">
<li>[palete &gt; straight line] (IJ:19.12.1)
<ul class="org-ul">
<li>try shift</li>
</ul></li>
<li>[palete &gt; color picker] (IJ:19.11)
<ul class="org-ul">
<li>e.g. choose black as foreground</li>
<li>try Draw (d) (IJ:27.9-10)</li>
</ul></li>
<li>[palete &gt; flood fill tool] (IJ:19.16)
<ul class="org-ul">
<li>use again: color or picker to choose right color for filling</li>
</ul></li>
<li>[palete &gt; wand tracking tool] (IJ:19.7)
<ul class="org-ul">
<li>use to select shapes</li>
<li>apply Copy (ctrl-c), Paste (ctrl-v), Cut (ctrl-x)</li>
<li>alternatively select, move selection, choose color and try Fill (f), Draw (d), Clear tools (IJ:27.2 IJ:27.9-10)</li>
</ul></li>
<li>[palete &gt; rectangular selection] (IJ:19.1)
<ol class="org-ol">
<li>select a rectangular shape around blue rectangle</li>
<li>apply Copy (ctrl-c), Paste (ctrl-v)</li>
</ol></li>
</ol></li>
</ol>
</div>
</div>

<div id="outline-container-orgb05d131" class="outline-3">
<h3 id="orgb05d131"><span class="section-number-3">1.3.</span> image inspection</h3>
<div class="outline-text-3" id="text-1-3">
<ol class="org-ol">
<li>open the &ldquo;single_channel.tif&rdquo; image (drag &amp; drop, or File &gt; Open)</li>
<li>Image &gt; Duplicate (IJ:28.9)
<ul class="org-ul">
<li>shortcut: D (shift-d)</li>
</ul></li>
<li>Analyze &gt; Histogram (IJ:30.10)
<ul class="org-ul">
<li>Shortcut: h</li>
</ul></li>
<li>click &ldquo;live&rdquo;</li>
<li>Image &gt; Adjust &gt; Brightness/Contrast
<ol class="org-ol">
<li>play with sliders and Auto and Set and Reset</li>
<li>observe histogram window&#x2013;what is changing, what is not?</li>
<li>click Apply</li>
<li>what changed?</li>
</ol></li>
</ol>
</div>
</div>
<div id="outline-container-org31c8d7e" class="outline-3">
<h3 id="org31c8d7e"><span class="section-number-3">1.4.</span> adjust brightness/contrast of all open images</h3>
<div class="outline-text-3" id="text-1-4">
<ol class="org-ol">
<li>open three single-channel images, in folder &ldquo;for_exercise_1.4&rdquo; (drag &amp; drop, or File &gt; Open)</li>
<li>for all images: Analyze &gt; Histogram (IJ:30.10) (Shortcut: h)
<ul class="org-ul">
<li>click &ldquo;live&rdquo;</li>
</ul></li>
<li>for one image: Image &gt; Adjust &gt; Brightness/Contrast</li>
<li>adjust contrast with sliders or Auto</li>
<li>click Set</li>
<li>check &ldquo;Propagate to all other open images&rdquo;-box</li>
<li>click OK</li>
<li>what happened to the histograms?</li>
<li>what happened to the images?</li>
<li>did pixel values change?</li>
<li>pick another image and repeat steps 4&#x2013;7</li>
<li>what happened, what is different, is it better/worse?</li>
</ol>
</div>
</div>

<div id="outline-container-org926ae07" class="outline-3">
<h3 id="org926ae07"><span class="section-number-3">1.5.</span> copy pasting from image to image</h3>
<div class="outline-text-3" id="text-1-5">
<ol class="org-ol">
<li><b>target:</b> create a figure illustrating the difference in C. elegans
phenotype (see elegance-fig.tif) based on elegans.tif example</li>
<li>file &gt; new &gt; image (IJ:26.1)
<ul class="org-ul">
<li>Type: 8bit</li>
<li>Slices: 1</li>
<li>Fill with: black</li>
</ul></li>
<li>file &gt; save as &gt; tif : my-elegance-fig.tif (IJ:26.10.1)</li>
<li>[palete &gt; color picker] (IJ:19.11)
<ul class="org-ul">
<li>choose white as foreground and black as background</li>
</ul></li>
<li>file &gt; open : [elegance.tif] (IJ:26.2)</li>
<li>find two different phenotypes of a worm; for each worm
<ul class="org-ul">
<li>select worm with [palete &gt; rectangular selection] (IJ:19.1)</li>
<li>edit &gt; selection &gt; add to manager (ctrl-t) (IJ:27.12.22)</li>
<li>analyze &gt; tools &gt; ROI manager</li>
</ul></li>
<li>prepare the template as in elegance example (see elegance-fig.tif)
<ul class="org-ul">
<li>[palete &gt; straight line] (ctrl-click to select <b>straight</b> mode) (IJ:19.2)
<ul class="org-ul">
<li>use line selection to create two horizontal lines (use shift while drawing)</li>
<li>create line; Draw (d); move line down; Draw (d); add to selection for future</li>
</ul></li>
<li>[palete &gt; text tool] (IJ:19.8)
<ul class="org-ul">
<li>add text for &ldquo;GFP&rdquo; and &ldquo;Brightfield&rdquo;</li>
<li>confirm with ctrl-d (or edit &gt; draw)</li>
</ul></li>
<li>use ROI manager to put ROIs into right places (analogous to elegance-fig.tif); for each ROI from original image:
<ul class="org-ul">
<li>paste ROI into new image</li>
<li>move it to desired location</li>
<li>add it to the ROI manager</li>
</ul></li>
</ul></li>
<li>copy paste selected worms to the new images (two channel per worm)
<ul class="org-ul">
<li>use ROI to find a worm position</li>
<li>choose channel: GFP or Brightfield</li>
<li>copy selection</li>
<li>choose my-elegance-fig.tif window</li>
<li>use ROI to select desired paste location</li>
<li>paste</li>
<li>repeat procedure for all four images</li>
</ul></li>
<li>file &gt; save (IJ:26.10.1)</li>
</ol>
</div>
</div>

<div id="outline-container-orgaff212a" class="outline-3">
<h3 id="orgaff212a"><span class="section-number-3">1.6.</span> file handling and non-invasive editing</h3>
<div class="outline-text-3" id="text-1-6">
<ol class="org-ol">
<li>file &gt; open samples &gt; blobs (shift-b) (IJ:26.4)</li>
<li>analyze &gt; tools &gt; scale bar (IJ:30.14.6)
<ul class="org-ul">
<li>set color, background, position</li>
<li>check: overlay, bold</li>
</ul></li>
<li>file &gt; save as &gt; tiff : blobs1.tif (IJ:26.10.1)
<ul class="org-ul">
<li>saving the image as tiff keeps the scale bar as an overlay, so pixel-values below it are kept</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org9480016" class="outline-3">
<h3 id="org9480016"><span class="section-number-3">1.7.</span> file handling and invasive editing</h3>
<div class="outline-text-3" id="text-1-7">
<ol class="org-ol">
<li>file &gt; open : [blobs1.tif] (IJ:26.2)
<ul class="org-ul">
<li>from the previous exercise</li>
</ul></li>
<li>image &gt; info (i) (IJ:28.3)</li>
<li>image &gt; overlay &gt; remove overlay (IJ:28.14.7)</li>
<li>analyze &gt; set scale  (IJ:30.8)
<ul class="org-ul">
<li>set scale such as image is 100 um long in each dimension</li>
</ul></li>
<li>analyze &gt; tools &gt; scale bar (IJ:30.14.6)
<ul class="org-ul">
<li>set color, background, position</li>
<li>check: NO overlay</li>
</ul></li>
<li>file &gt; save as &gt; tiff : blobs2.tif (IJ:26.10.1)
<ul class="org-ul">
<li>load again to check the difference (e.g. check info)</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org5f4be3c" class="outline-3">
<h3 id="org5f4be3c"><span class="section-number-3">1.8.</span> LUT and calibration bar</h3>
<div class="outline-text-3" id="text-1-8">
<ol class="org-ol">
<li><b>target:</b> verrify that images &ldquo;looking&rdquo; alike might be different</li>
<li>file &gt; open samples &gt; blobs (shift-b) (IJ:26.4)</li>
<li>inspect pixel values (IJ:p.28:Toolbar)</li>
<li>image &gt; lookup table &gt; invert LUT (IJ:28.15.1)</li>
<li>change color lookup table
<ul class="org-ul">
<li>Image &gt; Look up table &gt; Fire</li>
</ul></li>
<li>analyze &gt; tools &gt; calibration bar (IJ:30.14.7)</li>

<li>file &gt; open &gt; [blobs16bit.tif] (IJ:26.2)</li>
<li>change color lookup table
<ul class="org-ul">
<li>Image &gt; Look up table &gt; Fire</li>
</ul></li>
<li>analyze &gt; tools &gt; calibration bar (IJ:30.14.7)</li>
</ol>
</div>
</div>

<div id="outline-container-orgf822c40" class="outline-3">
<h3 id="orgf822c40"><span class="section-number-3">1.9.</span> 8-bit and 16-bit pseudocolor images</h3>
<div class="outline-text-3" id="text-1-9">
<ol class="org-ol">
<li>file &gt; open samples &gt; blobs (shift-b) (IJ:26.4)</li>
<li>inspect pixel values (IJ:p.28:Toolbar)</li>
<li>image &gt; lookup table &gt; invert LUT (IJ:28.15.1)</li>
<li>analyze &gt; tools &gt; calibration bar (IJ:30.14.7)</li>

<li>file &gt; open &gt; [blobs16bit.tif] (IJ:26.2)</li>
<li>inspect pixel values (IJ:p.28:Toolbar)
<ul class="org-ul">
<li>alternatively use Pixel Inspector (IJ:19.20)</li>
</ul></li>
<li>analyze &gt; tools &gt; calibration bar (IJ:30.14.7)</li>

<li>file &gt; open samples &gt; blobs (shift-b) (IJ:26.4)</li>
<li>add arrow in overlay (IJ:19.13)
<ul class="org-ul">
<li>play with the look of the arrow (i.e. colors, thickness)</li>
<li>indicate a blob which you like</li>
<li>confirm by ctrl-b (IJ:19.8)</li>
</ul></li>
<li>add arrow in draw (IJ:19.13)
<ul class="org-ul">
<li>confirm by ctrl-d (IJ:19.8)</li>
</ul></li>
<li>mark a part of image with overlay brush (IJ:19.18)
<ul class="org-ul">
<li>play with transparency</li>
<li>cover blobs marked by arrows with red paint</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-orge39fc93" class="outline-3">
<h3 id="orge39fc93"><span class="section-number-3">1.10.</span> pseudocolor image to RGB conversion</h3>
<div class="outline-text-3" id="text-1-10">
<ol class="org-ol">
<li>file &gt; open samples &gt; blobs (shift-b) (IJ:26.4)</li>
<li>image &gt; duplicate (IJ:28.9)</li>
<li>rename images: left and right
<ul class="org-ul">
<li>image &gt; rename (IJ:28.10)</li>
</ul></li>
<li>change color lookup table for left and right
<ul class="org-ul">
<li>Image &gt; Look up table &gt; Fire | green</li>
</ul></li>
<li>duplicate both images (IJ:28.9)
<ul class="org-ul">
<li>name them left-1 and right-1</li>
</ul></li>
<li>image &gt; stack &gt; tools &gt; combine (IJ:28.6.15.1)
<ul class="org-ul">
<li>select left and right</li>
</ul></li>
<li>select left-1
<ul class="org-ul">
<li>image &gt; type &gt; Color RGB (IJ:7)</li>
<li>check with picker what are the values in pixels (IJ:p.28:Toolbar)</li>
</ul></li>
<li>select left-2
<ul class="org-ul">
<li>image &gt; type &gt; Color RGB (IJ:7)</li>
</ul></li>
<li>image &gt; stack &gt; tools &gt; combine (IJ:28.6.15.1)
<ul class="org-ul">
<li>select left-1 and right-1</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org8ad7e62" class="outline-3">
<h3 id="org8ad7e62"><span class="section-number-3">1.11.</span> color spaces</h3>
<div class="outline-text-3" id="text-1-11">
<ol class="org-ol">
<li>file &gt; open : [blob-combined.tif] (IJ:26.2)</li>
<li>plugins &gt; Color Inspector 3D</li>
<li>switch &ldquo;Display mode&rdquo; to histogram</li>
<li>play with color: rotation | saturation | brightness
<ul class="org-ul">
<li>compare RGB space with e.g. LAB</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org2124601" class="outline-3">
<h3 id="org2124601"><span class="section-number-3">1.12.</span> line-tool operations</h3>
<div class="outline-text-3" id="text-1-12">
<p>
<b>goal:</b> familiarize you with manual histogram adjustment and some built in rutines making this task easier
</p>
<ol class="org-ol">
<li>file &gt; open samples &gt; blobs (shift-b) (IJ:26.4)</li>
<li>image &gt; lookup tables &gt; invert LUT (IJ:28.15.1)</li>
<li>analyze &gt; histogram (IJ:30.10)
<ul class="org-ul">
<li>mark live</li>
</ul></li>
<li>select line tool (IJ:19.2) (IJ:p.28:Interface)</li>
<li>analyze &gt; plot profile (IJ:30.11)
<ul class="org-ul">
<li>mark Live</li>
<li>move line</li>
<li>double click on line icon</li>
<li>change line thickness (move line)</li>
</ul></li>
<li>edit &gt; selection &gt; select none</li>
<li>image &gt; adjust &gt; brightness/contrast (IJ:28.2.1)
<ul class="org-ul">
<li>play with settings to achieve white blobs and black background (actually you almost thresholded image)</li>
<li>apply when finished (note: pixel values are altered)</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org74ecc09" class="outline-3">
<h3 id="org74ecc09"><span class="section-number-3">1.13.</span> histogram based intensity transformations</h3>
<div class="outline-text-3" id="text-1-13">
<ol class="org-ol">
<li>file &gt; open samples &gt; M51 galaxy (IJ:26.4)</li>
<li>(2x) image &gt; duplicate (IJ:28.9)</li>
<li>(3x) analyze &gt; histogram (IJ:30.10)
<ul class="org-ul">
<li>mark live</li>
<li>check log button</li>
</ul></li>
<li>on each image
<ul class="org-ul">
<li>process &gt; enhance contrast (IJ:29.5)
<ul class="org-ul">
<li>normalize checked</li>
</ul></li>
<li>process &gt; enhance contrast (IJ:29.5)
<ul class="org-ul">
<li>equalize checked</li>
</ul></li>
<li>process &gt; enhance local contrast (CLAHE)
<ul class="org-ul">
<li><a href="http://fiji.sc/wiki/index.php/Enhance_Local_Contrast_(CLAHE)">http://fiji.sc/wiki/index.php/Enhance_Local_Contrast_(CLAHE)</a></li>
<li>try different setting (block size ~30, histogram bins ~200, max slope: ~30)</li>
<li>what settings brings the result close to the (global) histogram equalization?</li>
<li>what happens at small block sizes and large max slopes? why?</li>
</ul></li>
</ul></li>
<li>compare the results</li>
</ol>
</div>
</div>

<div id="outline-container-orgce82828" class="outline-3">
<h3 id="orgce82828"><span class="section-number-3">1.14.</span> histogram adjustments</h3>
<div class="outline-text-3" id="text-1-14">
<ol class="org-ol">
<li><b>target:</b> familiarize with manual histogram adjustment and HiLo LUT</li>
<li>file &gt; open &gt; [dudes.jpg] (IJ:26.2)</li>
<li>analyze &gt; histogram (IJ:30.10)
<ul class="org-ul">
<li>mark live</li>
</ul></li>
<li>image &gt; lookup tables &gt; invert LUT (IJ:28.15.1)</li>
<li>image &gt; adjust &gt; brightness/contrast (IJ:28.2.1)
<ul class="org-ul">
<li>play with settings to increase contrast in the image (actually you almost thresholded image)</li>
<li>apply when finished (note: pixel values are altered; see histogram)</li>
</ul></li>
<li>process &gt; enhance contrast (IJ:29.5)
<ul class="org-ul">
<li>equalize un-checked</li>
<li>normalize un-checked</li>
</ul></li>
<li>What is happening when saturated pixels is equal to 5%?</li>
</ol>
</div>
</div>

<div id="outline-container-orgb03ff17" class="outline-3">
<h3 id="orgb03ff17"><span class="section-number-3">1.15.</span> using 16 bit images to increase precision</h3>
<div class="outline-text-3" id="text-1-15">
<ol class="org-ol">
<li>file &gt; open samples &gt; M51 galaxy (IJ:26.4)</li>
<li>image &gt; lookup tables &gt; fire (IJ:28.15)</li>
<li>image &gt; duplicate (IJ:28.9)</li>
<li>(2x) analyze &gt; histogram (IJ:30.10)
<ul class="org-ul">
<li>mark live</li>
<li>check log button</li>
</ul></li>
<li>on first image:
<ul class="org-ul">
<li>image &gt; type &gt; 8 bit</li>
<li>process &gt; enhance contrast (IJ:29.5)
<ul class="org-ul">
<li>equalize checked</li>
</ul></li>
</ul></li>
<li>on second image:
<ul class="org-ul">
<li>process &gt; enhance contrast (IJ:29.5)
<ul class="org-ul">
<li>equalize checked</li>
</ul></li>
</ul></li>
<li>for both img.: image &gt; lookup tables &gt; fire (IJ:28.15)</li>
<li>select center of the galaxy with [palete &gt; rectangular
selection] (IJ:19.1)</li>
<li>edit &gt; selection &gt; add to manager (ctrl-t) (IJ:27.12.22)
<ul class="org-ul">
<li>analyze &gt; tools &gt; ROI manager</li>
<li>switch window to second image</li>
<li>click ROI you just added that it appears in the second image</li>
</ul></li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: mean gray value / standard deviation</li>
</ul></li>
<li>for both img.: analyze &gt; measure (m) (IJ:29.12.1)</li>
<li>for both img.: image &gt; lookup tables &gt; glasbey (IJ:28.15)</li>
<li>compare the results</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org1f69b20" class="outline-2">
<h2 id="org1f69b20"><span class="section-number-2">2.</span> working with multichannel images</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org89830a1" class="outline-3">
<h3 id="org89830a1"><span class="section-number-3">2.1.</span> create new image</h3>
<div class="outline-text-3" id="text-2-1">
<ol class="org-ol">
<li><b>target:</b> create a sketch of a cell as in [cell.tif]</li>
<li>file &gt; new &gt; image (IJ:26.1)
<ul class="org-ul">
<li>Type: 8bit</li>
<li>Slices: 2</li>
<li>Fill with: black</li>
</ul></li>
<li>[palete &gt; brush] (IJ:19.4)
<ul class="org-ul">
<li>right click on the [palete &gt; brush]
<ul class="org-ul">
<li>uncheck: &ldquo;Paint in overlay&rdquo;</li>
</ul></li>
</ul></li>
<li>[palete &gt; color picker] (IJ:19.11)
<ul class="org-ul">
<li>choose red as foreground</li>
</ul></li>
<li>Draw an outline of a cell ;)</li>
<li>image &gt; color &gt; channel tool (ctrl-z) (IJ:28.5.3)
<ul class="org-ul">
<li>make composite (IJ:28.5.5)</li>
</ul></li>
<li>Switch a slice with a slider</li>
<li>[palete &gt; color picker] (IJ:19.11)
<ul class="org-ul">
<li>choose blue as foreground</li>
</ul></li>
<li>Draw cell nuclei</li>
<li>[palete &gt; brush] (IJ:19.4)
<ul class="org-ul">
<li>right click on the [palete &gt; brush]
<ul class="org-ul">
<li>check: &ldquo;Paint in overlay&rdquo;</li>
</ul></li>
</ul></li>
<li>[palete &gt; color picker] (IJ:19.11)
<ul class="org-ul">
<li>choose blue as foreground</li>
</ul></li>
<li>Draw cell vesicles</li>
<li>Inspect pixel values (IJ:p.28:Toolbar)
<ul class="org-ul">
<li>alternatively use Pixel Inspector (IJ:19.20)</li>
<li>switch a slice with a slider</li>
<li>move inspector between: outline | nuclei | vesicles</li>
</ul></li>
<li>image &gt; color &gt; channel tool (ctrl-z) (IJ:28.5.3)
<ul class="org-ul">
<li>switch between composite | color | grey</li>
</ul></li>
<li>file &gt; save as &gt; tif : my-cell.tif (IJ:26.10.1)</li>
</ol>
</div>
</div>

<div id="outline-container-org7be33ca" class="outline-3">
<h3 id="org7be33ca"><span class="section-number-3">2.2.</span> composite images - splitting and merging</h3>
<div class="outline-text-3" id="text-2-2">
<ol class="org-ol">
<li>file &gt; open samples &gt; fluorescent cells (IJ:26.4)</li>
<li>image &gt; color &gt; arrange channels 
<ul class="org-ul">
<li>click on New 1, and select magenta</li>
</ul></li>
<li>image &gt; color &gt; split channels (IJ:28.5.1)</li>
<li>merge channels to composite
<ul class="org-ul">
<li>image &gt; color &gt; merge channels (IJ:28.5.2)</li>
<li>check &ldquo;create composite&rdquo; box (IJ:28.5.2)</li>
</ul></li>
<li>LUT
<ul class="org-ul">
<li>change LUT of the channels (LUT in the &ldquo;startup tools&rdquo;)</li>
</ul></li>
<li>color blindness
<ul class="org-ul">
<li>image &gt; color &gt; simulate color blindness</li>
<li>image &gt; color &gt; dichromacy</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org4d3c946" class="outline-3">
<h3 id="org4d3c946"><span class="section-number-3">2.3.</span> composite images - individual channel corrections</h3>
<div class="outline-text-3" id="text-2-3">
<p>
<b>goal:</b> create an image with brightfield / red / cyan channels which shows locations with strongest expression of these fluorophores 
</p>
<ol class="org-ol">
<li>file &gt; open samples &gt; neuron (IJ:26.4)</li>
<li>image &gt; color &gt; channel tool (IJ:28.7.5)</li>
<li>for each channel 
<ul class="org-ul">
<li>adjust contrast such as final image &ldquo;conveys the message&rdquo; (IJ:28.2.1)</li>
<li>Make sure to select the same channel in the channel tool and  with the slider in the image window otherwise you may be surprised that adjusting has no visible effect</li>
</ul></li>
<li>Save as jpg or  Image &gt; Type RGB color to remove other channels</li>
</ol>
</div>
</div>

<div id="outline-container-org6dd7202" class="outline-3">
<h3 id="org6dd7202"><span class="section-number-3">2.4.</span> microscopy stacks handling</h3>
<div class="outline-text-3" id="text-2-4">
<p>
<b>goal:</b> make a video and a picture for publication showing progression of mitosis in time (see: mitosis-montage.tif)
</p>
<ol class="org-ol">
<li>open : [mitosis-mixedStack.tif] (IJ:26.2)</li>
<li>image &gt; hyperstacks &gt; reorder hyperstacks
<ul class="org-ul">
<li>swap z with t (it is to overcome issues with make montages)</li>
</ul></li>
<li>image &gt; stacks &gt; tools &gt; make substack (IJ:28.6.15.7)
<ul class="org-ul">
<li>choose only one z slice e.g. 3rd one</li>
</ul></li>
<li>image &gt; duplicate (IJ:28.9)
<ul class="org-ul">
<li>check duplicate hyperstack</li>
</ul></li>
<li>image &gt; color &gt; channels tool (shift-z) (IJ:28.7.5)
<ul class="org-ul">
<li>split channels (IJ:28.5.1)</li>
</ul></li>
<li>for both C1 and C2 images
<ul class="org-ul">
<li>choose LUT Fire (IJ:19.7)</li>
<li>create channel label (IJ:19.8)</li>
<li>image &gt; type &gt; color RGB (IJ:7)</li>
</ul></li>
<li>for original two channel image
<ul class="org-ul">
<li>image &gt; type &gt; color RGB (IJ:7)</li>
</ul></li>
<li>image &gt; stacks &gt; tools &gt; combine (IJ:28.6.15.1)
<ul class="org-ul">
<li>choose left: 2 channel image</li>
<li>choose right: C1</li>
</ul></li>
<li>image &gt; stacks &gt; tools &gt; combine (IJ:28.6.15.1)
<ul class="org-ul">
<li>choose left: merged image</li>
<li>choose right: C2</li>
</ul></li>
<li>image &gt; stacks &gt; series labeler
<ul class="org-ul">
<li>select time and other options; use preview to peek</li>
</ul></li>
<li>file &gt; save as &gt; avi (IJ:26.10.1)
<ul class="org-ul">
<li>e.g. 10 frames per sec.</li>
</ul></li>
<li>image &gt; stacks &gt; make montage (IJ:28.6.8)
<ul class="org-ul">
<li>play with settings:
<ul class="org-ul">
<li>columns 1</li>
<li>rows 5</li>
<li>increments 12</li>
</ul></li>
</ul></li>
<li>file &gt; save as &gt; tiff (IJ:26.10.1)</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgd764406" class="outline-2">
<h2 id="orgd764406"><span class="section-number-2">3.</span> image processing: thresholding &amp; filters</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orga47fa47" class="outline-3">
<h3 id="orga47fa47"><span class="section-number-3">3.1.</span> basic concept of thresholding</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<b>target:</b> Threshold blob.gif image to create a mask enabling
   segmentation of blob-like structures (i.e. create an image where the
   values of all pixels not belonging to blob-like structures are
   set to 0, and all other pixel values are equal to 255).
</p>
<ol class="org-ol">
<li>file &gt; open samples &gt; blobs (IJ:26.4)</li>
<li>image &gt; lookup table &gt; invert LUT (IJ:28.15.1)</li>
<li>image &gt; duplicate (IJ:28.9)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>set up sliders and Dark background checkbox and threshold the
image:</li>
<li>use 126 value as threshold</li>
</ul></li>
<li>note: pixel values are altered</li>
<li>(optional) image &gt; adjust &gt; auto threshold</li>
</ol>
</div>
</div>

<div id="outline-container-org19337d5" class="outline-3">
<h3 id="org19337d5"><span class="section-number-3">3.2.</span> basic concept of filtering: binary filters</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<b>goal:</b> see different binary operations in action
</p>
<ol class="org-ol">
<li>open : [blobs-thr.tif] (IJ:26.2)</li>
<li>image &gt; duplicate (IJ:28.9)</li>
<li>process &gt; binary &gt; watershed (IJ:29.8.12)</li>
<li>process &gt; noise &gt; remove outliers (IJ:29.6.5)
<ul class="org-ul">
<li>check preview</li>
<li>list bright</li>
</ul></li>
<li>(process &gt; find maxima) (IJ:29.4)</li>
<li>(2x) process &gt; binary &gt; erode (IJ:29.8.3)</li>
<li>process &gt; find edges (IJ:29.3)</li>
<li>process &gt; binary &gt; fill holes (IJ:29.8.8)</li>
</ol>
</div>
</div>

<div id="outline-container-org54adf9e" class="outline-3">
<h3 id="org54adf9e"><span class="section-number-3">3.3.</span> basic concept of filters: sharpen</h3>
<div class="outline-text-3" id="text-3-3">
<ol class="org-ol">
<li>file &gt; open samples &gt; hela cells (IJ:26.4)</li>
<li>process &gt; filters &gt; unsharp mask (IJ:29.11.8)
<ul class="org-ul">
<li>check how it behaves when image is composite / color (use channel tool for this purpose) (IJ:28.7.5)</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-orgb89e783" class="outline-3">
<h3 id="orgb89e783"><span class="section-number-3">3.4.</span> edge filters - vertical stripes</h3>
<div class="outline-text-3" id="text-3-4">
<ol class="org-ol">
<li>open <code>vertical_stripes.tif</code></li>
<li>duplicate the <code>vertical_stripes.tif</code> original image
<ul class="org-ul">
<li><code>Image &gt; Duplicate</code> (shortcut: <code>shift-d</code>) (IJ:28.9)</li>
</ul></li>
<li>apply horizontal Prewitt filter:
<ul class="org-ul">
<li><code>Process &gt; Filters &gt; Convolve…</code></li>
<li><p>
as kernel input (Prewitt):
</p>
<pre class="example" id="org289ea43">
-1 -1 -1
0 0 0
1 1 1
</pre></li>
<li>click on OK.</li>
<li>do you understand the output of this process?</li>
</ul></li>
<li>duplicate the <code>vertical_stripes.tif</code> original image</li>
<li>apply vertical Prewitt filter:
<ul class="org-ul">
<li><code>Process &gt; Filters &gt; Convolve…</code></li>
<li><p>
as kernel input (Prewitt):
</p>
<pre class="example" id="orgadf99e6">
-1 0 1
-1 0 1
-1 0 1
</pre></li>
<li>click on <code>OK</code>.</li>
<li>do you understand the output of this process?</li>
</ul></li>
</ol>
</div>
</div>


<div id="outline-container-org2811360" class="outline-3">
<h3 id="org2811360"><span class="section-number-3">3.5.</span> edge filters - horizontal stripes</h3>
<div class="outline-text-3" id="text-3-5">
<p>
<i>The steps in this exercise are identical to 3.4&#x2014;only the input image differs</i>
</p>
<ol class="org-ol">
<li>open <code>horizontal_stripes.tif</code></li>
<li>duplicate the <code>horizontal_stripes.tif</code> original image
<ul class="org-ul">
<li><code>Image &gt; Duplicate</code> (shortcut: <code>shift-d</code>) (IJ:28.9)</li>
</ul></li>
<li>apply horizontal Prewitt filter:
<ul class="org-ul">
<li><code>Process &gt; Filters &gt; Convolve…</code></li>
<li><p>
as kernel input (Prewitt):
</p>
<pre class="example" id="org29a6b5d">
-1 -1 -1
0 0 0
1 1 1
</pre></li>
<li>click on OK.</li>
<li>do you understand the output of this process?</li>
</ul></li>
<li>duplicate the <code>horizontal_stripes.tif</code> original image</li>
<li>apply vertical Prewitt filter:
<ul class="org-ul">
<li><code>Process &gt; Filters &gt; Convolve…</code></li>
<li><p>
as kernel input (Prewitt):
</p>
<pre class="example" id="org71dba49">
-1 0 1
-1 0 1
-1 0 1
</pre></li>
<li>click on <code>OK</code>.</li>
<li>do you understand the output of this process?</li>
</ul></li>
</ol>
</div>
</div>



<div id="outline-container-org600a190" class="outline-3">
<h3 id="org600a190"><span class="section-number-3">3.6.</span> edge filters - checkerboard</h3>
<div class="outline-text-3" id="text-3-6">
<p>
<i>The steps in this exercise are identical to 3.4 or 3.5&#x2014;only the input image differs</i>
</p>
<ol class="org-ol">
<li>open <code>checkerboard.tif</code></li>
<li>duplicate the <code>checkerboard.tif</code> original image
<ul class="org-ul">
<li><code>Image &gt; Duplicate</code> (shortcut: <code>shift-d</code>) (IJ:28.9)</li>
</ul></li>
<li>apply horizontal Prewitt filter:
<ul class="org-ul">
<li><code>Process &gt; Filters &gt; Convolve…</code></li>
<li><p>
as kernel input (Prewitt):
</p>
<pre class="example" id="org018dd16">
-1 -1 -1
0 0 0
1 1 1
</pre></li>
<li>click on OK.</li>
<li>do you understand the output of this process?</li>
</ul></li>
<li>duplicate the <code>checkerboard.tif</code> original image</li>
<li>apply vertical Prewitt filter:
<ul class="org-ul">
<li><code>Process &gt; Filters &gt; Convolve…</code></li>
<li><p>
as kernel input (Prewitt):
</p>
<pre class="example" id="orgd442ede">
-1 0 1
-1 0 1
-1 0 1
</pre></li>
<li>click on <code>OK</code>.</li>
<li>do you understand the output of this process?</li>
</ul></li>
</ol>
</div>
</div>



<div id="outline-container-org41c3a9e" class="outline-3">
<h3 id="org41c3a9e"><span class="section-number-3">3.7.</span> Morphological filters - Binary</h3>
<div class="outline-text-3" id="text-3-7">
<ol class="org-ol">
<li>Open image <code>exercise_morphology.tif</code></li>
<li>duplicate the image 4 times and name each copy as following
<ul class="org-ul">
<li>Eroded</li>
<li>Dilated</li>
<li>Closed</li>
<li>Opened</li>
</ul></li>
<li>Apply binary morphological filters
<ul class="org-ul">
<li><code>Process &gt; Binary</code> (Erode, Dilate, Close, Open)</li>
<li>Note: Make sure you apply the operation that corresponds to the name of each image.</li>
</ul></li>
<li>Report findings</li>
</ol>
</div>
</div>

<div id="outline-container-orgd24d16c" class="outline-3">
<h3 id="orgd24d16c"><span class="section-number-3">3.8.</span> Morphological filters - Gray</h3>
<div class="outline-text-3" id="text-3-8">
<ol class="org-ol">
<li>Open image <code>exercise_morphology.tif</code></li>
<li>Apply Gray Morphological filters:
<ul class="org-ul">
<li><code>Process &gt; Morphology &gt; Gray Morphology</code></li>
</ul></li>
<li>Apply Image opening with circular structuring element with radius 3 - removes noise</li>
<li>Report: did it get rid of the noise?</li>
<li>Apply Image opening with circular structuring element with radius 5</li>
<li>Report: did it get rid of the tentacles from the top-left object?</li>
<li>With the line tool, measure the diameter of the holes in the bottom-right object.</li>
<li>Apply Image closing with circular structuring element with radius slightly larger than the radius</li>
<li>Report: did it get rid of the tentacles from the top-left circle?</li>
</ol>
</div>
</div>

<div id="outline-container-org9999e2a" class="outline-3">
<h3 id="org9999e2a"><span class="section-number-3">3.9.</span> basics mathematical operations on single image</h3>
<div class="outline-text-3" id="text-3-9">
<ol class="org-ol">
<li>open : [f2.tif] (IJ:26.2)</li>
<li>process &gt; math &gt; add (IJ:29.9.1)
<ul class="org-ul">
<li>play with different functions</li>
<li>check what happens when image is 32 bit</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-org5df77ed" class="outline-3">
<h3 id="org5df77ed"><span class="section-number-3">3.10.</span> beyond the limits of bits</h3>
<div class="outline-text-3" id="text-3-10">
<ol class="org-ol">
<li><b>target:</b> Perform consecutive addition and subtraction of the
same value from an image. Compare the results with original image.</li>
<li>open : [spooked_16bit.tif] (IJ:29.9.1)</li>
<li>image &gt; duplicate (IJ:28.9)
<ul class="org-ul">
<li>work on the copy</li>
</ul></li>
<li>process &gt; math &gt; add (IJ:29.9.1)
<ul class="org-ul">
<li>add value: 600</li>
</ul></li>
<li>process &gt; math &gt; subtract (IJ:29.9.2)
<ul class="org-ul">
<li>subtract value: 600</li>
</ul></li>
<li>comapare the original and the copy: are they the same? What has happened?</li>
</ol>
</div>
</div>
<div id="outline-container-org7da8a8f" class="outline-3">
<h3 id="org7da8a8f"><span class="section-number-3">3.11.</span> basics mathematical operations on two images</h3>
<div class="outline-text-3" id="text-3-11">
<ol class="org-ol">
<li>open : [f2.tif] and [f1.tif] (IJ:26.2)</li>
<li>process &gt; calculator (IJ:29.13)
<ul class="org-ul">
<li>start with add</li>
<li>check what happens when image is 32 bit</li>
<li>play with different functions</li>
</ul></li>
</ol>
</div>
</div>
<div id="outline-container-org38541d3" class="outline-3">
<h3 id="org38541d3"><span class="section-number-3">3.12.</span> seeing JPEG artifacts</h3>
<div class="outline-text-3" id="text-3-12">
<p>
<b>target:</b> Save the same image in TIFF and JPEG formats. Compare the differences
</p>
<ol class="org-ol">
<li>file &gt; open : [tulip.tif] (IJ:26.2)</li>
<li>image &gt; duplicate (IJ:28.9)
<ul class="org-ul">
<li>work on the copy</li>
</ul></li>
<li>file &gt; save as &gt; jpg (IJ:26.10.3)
<ul class="org-ul">
<li>tulip.jpg</li>
</ul></li>
<li>[palete &gt; pencil ] (IJ:19.19)
<ul class="org-ul">
<li>modify value of only one pixel</li>
</ul></li>
<li>file &gt; save as &gt; jpg (IJ:26.10.3)
<ul class="org-ul">
<li>tulip-1px.jpg</li>
</ul></li>
<li>close all jpeg files and reopen them</li>
<li>process &gt; calculator (IJ:29.13)
<ul class="org-ul">
<li>image1: tulip.tif</li>
<li>operation: subtract</li>
<li>image2: tulip.jpg</li>
<li>checked: create new window</li>
<li>checked: 32 bit result</li>
</ul></li>
<li>process &gt; calculator (IJ:29.13)
<ul class="org-ul">
<li>image1: tulip-1px.jpg</li>
<li>operation: subtract</li>
<li>image2: tulip.jpg</li>
<li>checked: create new window</li>
<li>checked: 32 bit result</li>
</ul></li>
<li><b>questions:</b>
<ul class="org-ul">
<li>What are the differences between images tif and jpg images? Why?</li>
<li>How many pixels are affected by changing only 1 pixel in jpg image? Why?</li>
</ul></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgb2f8a03" class="outline-2">
<h2 id="orgb2f8a03"><span class="section-number-2">4.</span> background elimination</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgb7cf73b" class="outline-3">
<h3 id="orgb7cf73b"><span class="section-number-3">4.1.</span> dividing by background image</h3>
<div class="outline-text-3" id="text-4-1">
<ol class="org-ol">
<li><b>target:</b> Estimate the local ratio of increase by dividing the
image by background. Check the impact of 32-bit image conversion
on the quatlity of the result.</li>
<li>file &gt; open : [xxx.tif] (IJ:26.2)</li>
<li>file &gt; open : [xxx_background.tif] (IJ:26.2)</li>
<li>process &gt; calculator (IJ:29.13)
<ul class="org-ul">
<li>image1: xxx.tif</li>
<li>operation: subtract</li>
<li>image2: xxx_background.tif</li>
<li>checked: create new window</li>
<li>checked: 32 bit result</li>
</ul></li>
<li>process &gt; calculator (IJ:29.13)
<ul class="org-ul">
<li>image1: xxx.tif</li>
<li>operation: subtract</li>
<li>image2: xxx_background.tif</li>
<li>checked: create new window</li>
<li>unchecked: 32 bit result</li>
</ul></li>
<li><b>question:</b> what is the reason of <a href="https://en.wikipedia.org/wiki/Posterization">posterization</a> ?</li>
</ol>
</div>
</div>

<div id="outline-container-org63bceb5" class="outline-3">
<h3 id="org63bceb5"><span class="section-number-3">4.2.</span> background elimination - flat field correction</h3>
<div class="outline-text-3" id="text-4-2">
<ol class="org-ol">
<li>file &gt; open &gt; cell colony (IJ:26.4)</li>
<li>use selection to draw a horizontal line across the image (IJ:19.2)</li>
<li>analyze &gt; plot profile
<ul class="org-ul">
<li>check live</li>
</ul></li>
<li>process &gt; subtract background
<ul class="org-ul">
<li>click: preview</li>
<li>click: create background</li>
<li>vary: rolling ball radius</li>
<li>try: sliding paraboloid</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org0d571cb" class="outline-3">
<h3 id="org0d571cb"><span class="section-number-3">4.3.</span> background elimination - flat field correction using Image calculator</h3>
<div class="outline-text-3" id="text-4-3">
<ol class="org-ol">
<li>file &gt; open samples &gt; cell colony (IJ:26.4)</li>
<li>image &gt; duplicate (IJ:28.9)</li>
<li>process &gt; filters &gt; gaussian blur % sigma ~= 30 (IJ:29.11.2)</li>
<li>measure mean of blurred image (select it, &ldquo;a&rdquo;, &ldquo;m&rdquo;) (IJ:29.12.1)</li>
<li>process &gt; calculator plus &gt; divide (i1 = image, i2 = blurred image, k1 = mean, k2 = 0)</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org89b5d08" class="outline-2">
<h2 id="org89b5d08"><span class="section-number-2">5.</span> manual measurements and working with rois</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org35f9030" class="outline-3">
<h3 id="org35f9030"><span class="section-number-3">5.1.</span> measuring fluorescence within a selection</h3>
<div class="outline-text-3" id="text-5-1">
<ol class="org-ol">
<li>task : measure average flu. in Red channel in neuron</li>
<li>file &gt; open samples &gt; neuron (IJ:26.4)</li>
<li>image &gt; color &gt; channel tool (IJ:28.7.5)
<ul class="org-ul">
<li>split channels (IJ:28.5.1)</li>
</ul></li>
<li>close all but green and red</li>
<li>work on green image
<ul class="org-ul">
<li>image &gt; duplicate (IJ:28.9)</li>
<li>process &gt; filters &gt; gaussian blur (IJ:29.11.2)
<ul class="org-ul">
<li>use preview to set parameters</li>
</ul></li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>threshold to create neuron mask (avoid false negatives)</li>
</ul></li>
<li>use wand tool to select main part of the neuron (IJ:19.7)</li>
<li>analyze &gt; tools &gt; roi manager (IJ:30.14.5)
<ul class="org-ul">
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
</ul></li>
</ul></li>
<li>choose second copy of green
<ul class="org-ul">
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>threshold to create neuron mask (avoid false negatives)</li>
</ul></li>
<li>edit &gt; selection &gt; create selection (IJ:27.12.11)</li>
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
<li>edit &gt; selection &gt; select none (ctrl-shift-a) (IJ:27.12.2)</li>
<li>process &gt; noise &gt; remove outliers (IJ:29.6.5)
<ul class="org-ul">
<li>use preview; remove some of the outliers outside of neuron</li>
</ul></li>
<li>edit &gt; selection &gt; create selection (IJ:27.12.11)</li>
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
</ul></li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: area / area fraction / mean gray value</li>
</ul></li>
<li>work on red image
<ul class="org-ul">
<li>choose multi point tool (IJ:19.5)
<ul class="org-ul">
<li>select some points in the neuron</li>
<li>edit &gt; selection &gt; enlarge (IJ:27.12.14)</li>
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
</ul></li>
</ul></li>
<li>for each selection
<ul class="org-ul">
<li>analyze &gt; measure (m) (IJ:29.12.1)</li>
</ul></li>
<li>roi manager &gt; more &gt; save selection (IJ:30.14.5)</li>
</ol>
</div>
</div>

<div id="outline-container-org26ac749" class="outline-3">
<h3 id="org26ac749"><span class="section-number-3">5.2.</span> measuring geometrical properties in the image</h3>
<div class="outline-text-3" id="text-5-2">
<ol class="org-ol">
<li>task : measure average flu. in Red channel in neuron</li>
<li>file &gt; open samples &gt; neuron (IJ:26.4)</li>
<li>use polygon selection tool to measure cell body area (IJ:19.1.6)
<ul class="org-ul">
<li>use measure to get the read out after creating polygon (IJ:29.12.1)
<ul class="org-ul">
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
</ul></li>
</ul></li>
<li>use segmented line tool (IJ:19.2.2) to measure length of few dendrites
<ul class="org-ul">
<li>test shift and alt while adding points (with mouse over a point)</li>
<li>use measure to get the read out after creating a line (IJ:29.12.1)</li>
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
</ul></li>
<li>use angle tool (IJ:19.2.2) to measure length of few dendrits
<ul class="org-ul">
<li>use measure to get the read out after creating an angle (IJ:29.12.1)</li>
<li>roi manager &gt; add (t) (IJ:27.12.22)</li>
</ul></li>
<li>roi manager &gt; more &gt; save selection (IJ:30.14.5)</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgce806f8" class="outline-2">
<h2 id="orgce806f8"><span class="section-number-2">6.</span> automatic measurements</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org97b0ebe" class="outline-3">
<h3 id="org97b0ebe"><span class="section-number-3">6.1.</span> identifying and measuring objects - basics</h3>
<div class="outline-text-3" id="text-6-1">
<ol class="org-ol">
<li>open : [blobs-thr.tif] (IJ:26.2)</li>
<li>image &gt; duplicate (IJ:28.9)</li>
<li>process &gt; binary &gt; watershed (IJ:29.8.12)</li>
<li>process &gt; noise &gt; remove outliers (IJ:29.6.5)
<ul class="org-ul">
<li>check preview</li>
</ul></li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: area / area fraction / mean gray value</li>
</ul></li>
<li>analyze &gt; analyze particles  (IJ:30.2)
<ul class="org-ul">
<li>test different options</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org07409a8" class="outline-3">
<h3 id="org07409a8"><span class="section-number-3">6.2.</span> identifying and measuring objects - cells #1</h3>
<div class="outline-text-3" id="text-6-2">
<ol class="org-ol">
<li><b>target:</b> measure distribution of RFP signal inside nucleus across cell population</li>
<li>open : [hela1.tif] (IJ:26.2)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>test different option to isolate cells</li>
</ul></li>
<li><b>question:</b> What are the difficulties?</li>
</ol>
</div>
</div>

<div id="outline-container-org1c5d126" class="outline-3">
<h3 id="org1c5d126"><span class="section-number-3">6.3.</span> identifying and measuring objects - cells #2</h3>
<div class="outline-text-3" id="text-6-3">
<ol class="org-ol">
<li><b>target:</b> measure distribution of RFP signal inside nucleus across cell population</li>
<li>open : [hela2.tif] (IJ:26.2)</li>
<li>image &gt; color &gt; split channel (IJ:28.5.1)</li>
<li>work on blue channel (DAPI)
<ul class="org-ul">
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)</li>
<li>process &gt; binary &gt; watershed (IJ:29.8.12)</li>
<li>process &gt; noise &gt; remove outliers (IJ:29.6.5)
<ul class="org-ul">
<li>check preview</li>
</ul></li>
</ul></li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: area / area fraction / mean gray value</li>
<li>redirect to: RFP</li>
</ul></li>
<li>analyze &gt; analyze particles  (IJ:30.2)</li>
<li>analyze &gt; distribution (IJ:30.4)
<ul class="org-ul">
<li>choose: gray value</li>
</ul></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org146e470" class="outline-2">
<h2 id="org146e470"><span class="section-number-2">7.</span> Segmentation</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org8f837f0" class="outline-3">
<h3 id="org8f837f0"><span class="section-number-3">7.1.</span> DAPI segmentation with thresholding</h3>
<div class="outline-text-3" id="text-7-1">
<ol class="org-ol">
<li>open <code>DAPI.tif</code> (single-channel image)</li>
<li>change LUT to Grays</li>
<li><code>Image &gt; Adjust &gt; Threshold</code></li>
<li>understand the function of the <code>Dark Background</code> checkbox (inspect pixel values)</li>
<li>try setting sliders manually</li>
<li>try different algorithms
<ul class="org-ul">
<li><code>Image &gt; Adjust &gt; Auto Threshold</code>, if you want to see all at the same time</li>
</ul></li>
<li>try different display options (<code>Red</code>, <code>B&amp;W</code>, <code>Over/Under</code>)&#x2014;do you understand what they show</li>
<li>when happy with result, click <code>Apply</code></li>
<li>save the resulting binary image (<code>File &gt; Save As &gt; Tiff...</code> )</li>
<li>Apply watershed to divide touching objects
<ul class="org-ul">
<li>select the binary image</li>
<li><code>Process &gt; Binary &gt; Watershed</code></li>
</ul></li>
<li>proceed with <code>Analyze &gt; Analyze Particles</code> 
<ul class="org-ul">
<li>select <code>Exclude on edges</code> and <code>Add to Manager</code></li>
<li>click on <code>OK</code></li>
</ul></li>
<li>Bonus: repeat step 11 but use the <code>Size</code> and <code>Circularity</code> options to try to exclude some particles and the <code>Show</code> dropdown menu to visualize different outputs.</li>
<li>Set the parameters you want to measure:
<ul class="org-ul">
<li><code>Analyze &gt; Set measurement</code></li>
<li>select <code>Area</code>, <code>Mean gray value</code>, <code>Min &amp; max gray value</code>, <code>Display label</code></li>
<li>click on <code>OK</code></li>
</ul></li>
<li>Select the original image (open it again as in step 1 if you do not have it)</li>
<li>In the <code>ROI Manager</code>, click on <code>Deselect</code> and then on <code>Measure</code></li>
<li>Save the <code>Results</code> table as .csv (select the table and click on <code>File &gt; Save As…</code>)</li>
</ol>
</div>
</div>





<div id="outline-container-orgdb06b3a" class="outline-3">
<h3 id="orgdb06b3a"><span class="section-number-3">7.2.</span> DAPI segmentation with filters and thresholding</h3>
<div class="outline-text-3" id="text-7-2">
<ol class="org-ol">
<li>open <code>DAPI_noise.tif</code></li>
<li>change LUT to Grays</li>
<li><code>Image &gt; Adjust &gt; Threshold</code></li>
<li>understand the function of the Dark Background checkbox (inspect pixel values)</li>
<li>try setting sliders manually. Can you find a good threshold range?</li>
<li>try different algorithms. Can you find one that gives a good result? 		
<ul class="org-ul">
<li><code>Image &gt; Adjust &gt; Auto Threshold</code>, if you want to see all at the same time</li>
</ul></li>
<li>duplicate the <code>DAPI_noise.tif</code> image
<ul class="org-ul">
<li><code>Image &gt; Duplicate</code> (shortcut: <code>shift-d</code>) (IJ:28.9)</li>
</ul></li>
<li>apply a filter of your choice (Mean, Gaussian Blur, Median, …)
<ul class="org-ul">
<li><code>Process &gt; Filters</code></li>
<li>check the <code>Preview</code> checkbox</li>
<li>change the <code>Radius</code> / <code>Sigma</code>. What happens to the image?</li>
<li>when you are happy, click on <code>OK</code></li>
</ul></li>
<li>now perform steps 5 and 6 again</li>
<li>repeat steps 8, 5 and 6 until happy with result, then click <code>Apply</code></li>
<li>save the resulting binary image (<code>File &gt; Save As &gt; Tiff...</code> )</li>
<li>Apply watershed to divide touching objects
<ul class="org-ul">
<li>select the binary image</li>
<li><code>Process &gt; Binary &gt; Watershed</code></li>
</ul></li>
<li>proceed with <code>Analyze &gt; Analyze Particles</code> 
<ul class="org-ul">
<li>select <code>Exclude on edges</code> and <code>Add to Manager</code></li>
<li>click on <code>OK</code></li>
</ul></li>
<li>Bonus: repeat step 11 but use the <code>Size</code> and <code>Circularity</code> options to try to exclude some particles and the <code>Show</code> dropdown menu to visualize different outputs.</li>
<li>Set the parameters you want to measure:
<ul class="org-ul">
<li><code>Analyze &gt; Set measurement</code></li>
<li>select <code>Area</code>, <code>Mean gray value</code>, <code>Min &amp; max gray value</code>, <code>Display label</code></li>
<li>click on <code>OK</code></li>
</ul></li>
<li>Select the original image (open it again as in step 1 if you do not have it)</li>
<li>In the <code>ROI Manager</code>, click on <code>Deselect</code> and then on <code>Measure</code></li>
<li>Save the <code>Results</code> table as .csv (select the table and click on <code>File &gt; Save As…</code>)</li>
</ol>
</div>
</div>




<div id="outline-container-org0685c02" class="outline-3">
<h3 id="org0685c02"><span class="section-number-3">7.3.</span> DAPI segmentation with Weka</h3>
<div class="outline-text-3" id="text-7-3">
<ol class="org-ol">
<li>open <code>hela-1.tif</code> (single-channel image)</li>
<li>change LUT to Grays</li>
<li><code>Plugins &gt; Segmentation &gt; Trainable Weka Segmentation</code></li>
<li>draw a line outside a nucleus</li>
<li>click <code>Add to class 1</code></li>
<li>draw a line inside a nucleus</li>
<li>click <code>Add to class 2</code></li>
<li>click <code>Train classifier</code></li>
<li>repeat the last four steps until happy with result</li>
<li>click <code>Get probability</code></li>
<li>inspect the probability maps, do you understand the meaning of the values of the pixels in the different channels?</li>
<li>click <code>Create result</code></li>
<li>inspect results, do you understand the meaning of the values of the pixels in the different channels?
<ol class="org-ol">
<li>you now have a binary image, but not the kind Fiji likes</li>
<li>to measure, proceed by thresholding (&ldquo;set&rdquo; both threshold values to 1), then Analyze Particles, etc</li>
<li>alternatively, multiply all values in the Weka output image by 255, then apply Binarize, etc</li>
</ol></li>
<li>save the resulting image (<code>File &gt; Save As &gt; Tiff...</code> ) with name &ldquo;myWekaHeLa1.tif&rdquo;</li>
<li>Bonus round: play with Settings</li>
</ol>
</div>
</div>

<div id="outline-container-orgd9cfcc5" class="outline-3">
<h3 id="orgd9cfcc5"><span class="section-number-3">7.4.</span> DAPI double-segmentation with Weka</h3>
<div class="outline-text-3" id="text-7-4">
<ol class="org-ol">
<li>open hela-1.tif (single-channel image)</li>
<li>change LUT to Grays</li>
<li><code>Process &gt; Enhance Contrast &gt; Histogram Equalization</code></li>
<li><code>Plugins &gt; Segmentation &gt; Trainable Weka Segmentation</code></li>
<li>draw a line outside the cells</li>
<li>click <code>Add to class 1</code></li>
<li>draw a line inside a nucleus</li>
<li>click <code>Add to class 2</code></li>
<li>draw a line inside the cytoplams</li>
<li>click <code>Add to class 3</code></li>
<li>click <code>Train classifier</code></li>
<li>repeat the last six steps until happy with result</li>
<li>inspect the probability maps, do you understand the meaning of the values of the pixels in the different channels?</li>
<li>click <code>Create result</code></li>
<li>inspect results, do you understand the meaning of the values of the pixels in the different channels?
<ul class="org-ul">
<li>you now have an image with three values</li>
<li>to measure, proceed by thresholding at 0, 1, and 2, to extract each class (use Set and then set both thresholds to 0, 1, or 2)</li>
<li>then proceed with Analyze Particles, etc for each of the classes of interest (nuclei and cytoplasm)</li>
</ul></li>
<li>Bonus round: play with Settings</li>
</ol>
</div>
</div>

<div id="outline-container-orgd360039" class="outline-3">
<h3 id="orgd360039"><span class="section-number-3">7.5.</span> DAPI segmentation with StarDist</h3>
<div class="outline-text-3" id="text-7-5">
<ol class="org-ol">
<li>Follow StarDist installation instructions from here
<ul class="org-ul">
<li><a href="https://imagej.net/plugins/stardist">https://imagej.net/plugins/stardist</a></li>
</ul></li>
<li>open <code>hela-1.tif</code> (single-channel image)</li>
<li>change LUT to Grays</li>
<li><code>Plugins &gt; StarDist &gt; StarDist 2D</code></li>
<li><code>Model: Versatile (fluorescent nuclei)</code></li>
<li>click <code>OK</code> and wait</li>
<li>after result shows
<ul class="org-ul">
<li>select original image</li>
<li>select <code>ROI Manager</code></li>
<li>check the <code>Show All</code> box</li>
</ul></li>
<li>comment on the result, is it good/bad?</li>
</ol>
</div>
</div>
<div id="outline-container-org17d2ca8" class="outline-3">
<h3 id="org17d2ca8"><span class="section-number-3">7.6.</span> H&amp;E segmentation with StarDist</h3>
<div class="outline-text-3" id="text-7-6">
<ol class="org-ol">
<li>open <code>H&amp;E_retina.jpg</code> (RGB image)</li>
<li><code>Plugins &gt; StarDist &gt; StarDist 2D</code></li>
<li><code>Model: Versatile (H&amp;E nuclei)</code></li>
<li>click <code>OK</code> and wait</li>
<li>after result shows
<ul class="org-ul">
<li>select original image</li>
<li>select <code>ROI Manager</code></li>
<li>check the <code>Show All</code> box</li>
</ul></li>
<li>comment on the result, is it good/bad?</li>
<li>duplicate original image</li>
<li>re-scale it by factor of 0.5 in x and y (Image &gt; Scale)</li>
<li>apply StarDist again and overlay the ROIs as above</li>
<li>is there a difference? why?</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org879d61f" class="outline-2">
<h2 id="org879d61f"><span class="section-number-2">8.</span> Spot detection</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgb0ae0bb" class="outline-3">
<h3 id="orgb0ae0bb"><span class="section-number-3">8.1.</span> manual spot detection with the Multi-point Tool (<a href="https://imagej.nih.gov/ij/docs/guide/146-19.html#toc-Subsection-19.6">IJ:19.6</a>)</h3>
<div class="outline-text-3" id="text-8-1">
<ol class="org-ol">
<li>read all the next steps before beginning</li>
<li>open <code>spot_detection/beads_001.tif</code></li>
<li>right-click (ctrl-click) on the <code>Point Tool</code> in the tool bar and select <code>Multi Tool</code></li>
<li>double-click on the <code>Point Tool</code> in the tool-bar and customize to your liking (test on image, clear points by shift-a)</li>
<li>count all beads by clicking on them one by one</li>
<li>how long did it take you to click on all the beads (measure with stopwatch the time it took to complete the previous step)?</li>
<li>save results to the <code>ROI Manager</code> (t) then to file (More &gt;&gt; Save &#x2026;)</li>
<li>click <code>measure</code> in the <code>ROI Manager</code> to get number of spots</li>
</ol>
</div>
</div>

<div id="outline-container-orgff1f04a" class="outline-3">
<h3 id="orgff1f04a"><span class="section-number-3">8.2.</span> algorithmic spot detection with Find Maxima (<a href="https://imagej.nih.gov/ij/docs/guide/146-29.html#toc-Subsection-29.4">IJ:29.4</a>)</h3>
<div class="outline-text-3" id="text-8-2">
<p>
<a href="https://forum.image.sc/t/new-maxima-finder-menu-in-fiji/25504">Forum post about Find Maxima</a>
</p>
<ol class="org-ol">
<li>open <code>spot_detection/beads_001.tif</code></li>
<li><code>Process &gt; Find Maxima ...</code></li>
<li>check <code>Preview point selection</code></li>
<li>try different values for <code>Prominence</code> and the three check-boxes</li>
<li>try each of the possibilities in the pull-down (remember to click OK to apply your selection)
<ul class="org-ul">
<li>what is the difference and what could the different outputs be used for?</li>
<li>tip: shift-u allows you to pin sub-menus of the control panel for quick selection, e.g. the Process menu</li>
</ul></li>
<li>add you detected maxima (<code>Point Selection</code>) to the <code>ROI Manager</code> and save to file</li>
<li>load saved ROIs from the manual detection exercise and compare results
<ul class="org-ul">
<li>how many beads do you get and how does the number compare to your manual count?</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org3bfa7b5" class="outline-3">
<h3 id="org3bfa7b5"><span class="section-number-3">8.3.</span> automatic spot segmentation with thresholding</h3>
<div class="outline-text-3" id="text-8-3">
<ol class="org-ol">
<li>open <code>spot_detection/beads_001.tif</code></li>
<li><code>Image &gt; Adjust &gt; Threshold ...</code>
<ul class="org-ul">
<li>select <code>Otsu</code>, then apply</li>
</ul></li>
<li><p>
<code>Analyze &gt; Set Measurements ...</code>
</p>
<pre class="example">
+ [X] Area
+ [X] Mean gray value
+ [X] Display label
</pre></li>
<li><p>
<code>Analyze &gt; Analyze Particles ...</code>
</p>
<pre class="example">
+ Show: Overlay Masks
+ [X] Display results
+ [X] Clear Results
+ [X] Summarize
+ [X] Add to Manager
</pre></li>
<li>save ROIs to file</li>
<li>Compare results to the previous two approaches
<ul class="org-ul">
<li>Do they differ significantly from each other?</li>
<li>Which performed better?</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org36747c7" class="outline-3">
<h3 id="org36747c7"><span class="section-number-3">8.4.</span> spot detection with noise</h3>
<div class="outline-text-3" id="text-8-4">
<ol class="org-ol">
<li>Repeat 8.2 with <code>with_noise_8000.tif</code>
<ul class="org-ul">
<li>consider smoothing the image first:
<ul class="org-ul">
<li><code>Process &gt; Smooth</code> (this is a 3x3 mean filter)</li>
</ul></li>
</ul></li>
<li>Repeat 8.3 with <code>with_noise_8000.tif</code>
<ul class="org-ul">
<li>consider smoothing the image first:
<ul class="org-ul">
<li><code>Process &gt; Filters</code></li>
<li>then pick one</li>
</ul></li>
</ul></li>
<li>Compare and comment on the performance of the two methods
<ul class="org-ul">
<li>Which one is better?</li>
<li>Why/how is it better?</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org623ed14" class="outline-3">
<h3 id="org623ed14"><span class="section-number-3">8.5.</span> spot detection with variable background</h3>
<div class="outline-text-3" id="text-8-5">
<ol class="org-ol">
<li>Repeat 8.2 with <code>beads_001_ramp.tif</code></li>
<li>Repeat 8.3 with <code>beads_001_ramp.tif</code></li>
<li>Compare and comment on the performance of the two methods
<ul class="org-ul">
<li>Which one is better?</li>
<li>Why/how is it better?</li>
</ul></li>
<li>What could be done to the image to make thresholding work better?</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgfb3bb5c" class="outline-2">
<h2 id="orgfb3bb5c"><span class="section-number-2">9.</span> scripting / macros / automation basics</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orgf40d009" class="outline-3">
<h3 id="orgf40d009"><span class="section-number-3">9.1.</span> macro recorder - reproducing edits</h3>
<div class="outline-text-3" id="text-9-1">
<ol class="org-ol">
<li><b>target:</b> save the edit chain for later (to save work and to
document parameters used by different filters)</li>
<li>plugins &gt; macro &gt; recorder (IJ:31.1.4)</li>
<li>file &gt; open samples &gt; mri-stack (IJ:26.4)</li>
<li>process &gt; filters &gt; gaussian blur with sigma ~= 2 (IJ:29.11.2)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>select manually threshold such as the head is separated from background
<ul class="org-ul">
<li>ignore small holes</li>
<li>uncheck box: calculate threshold for each image</li>
</ul></li>
</ul></li>
<li>process &gt; binary &gt; fill holes (IJ:29.8.8)</li>
<li>(optional) use analyze &gt; set scale to calibrate the measurement units
<ul class="org-ul">
<li>200 pixels is 25 cm</li>
</ul></li>
<li><b>Question:</b> What are the benefits of storing such a macro?</li>
</ol>
</div>
</div>

<div id="outline-container-org7dc3578" class="outline-3">
<h3 id="org7dc3578"><span class="section-number-3">9.2.</span> macro recorder - repeating actions on stack</h3>
<div class="outline-text-3" id="text-9-2">
<ol class="org-ol">
<li><b>target:</b> calculate the volume of human skull</li>
<li>file &gt; open samples &gt; mri-stack (IJ:26.4)
<ul class="org-ul">
<li>use steps below or macro developed in previous excercise</li>
</ul></li>
<li>process &gt; filters &gt; gaussian blur % sigma ~= 2 (IJ:29.11.2)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>select manually threshold such as the head is separated from background
<ul class="org-ul">
<li>ignore small holes</li>
</ul></li>
</ul></li>
<li>process &gt; binary &gt; fill holes (IJ:29.8.8)</li>
<li>(optional) use set scale to calibrate the measurement units
<ul class="org-ul">
<li>200 pixels is 25 cm</li>
</ul></li>
<li>plugins &gt; macro &gt; recorder (IJ:31.1.4)</li>
<li>analyse &gt; measure (IJ:29.12.1)</li>
<li>image &gt; stacks &gt; next slice (IJ:28.6.3)</li>
<li>in recorder click <code>create</code> button</li>
<li><p>
use copy paste to execute the same action many times:
</p>
<pre class="example">
run("Next Slice [&gt;]");
run("Measure");
run("Next Slice [&gt;]");
run("Measure");
run("Next Slice [&gt;]");
run("Measure");
run("Next Slice [&gt;]");
run("Measure");
</pre></li>
<li><b>Question:</b> how to compute volume of human skull based on the measurement?</li>
</ol>
</div>
</div>

<div id="outline-container-org0cfb643" class="outline-3">
<h3 id="org0cfb643"><span class="section-number-3">9.3.</span> automatic iteration</h3>
<div class="outline-text-3" id="text-9-3">
<ol class="org-ol">
<li><b>target:</b> avoid copy pasting - use iteration instead</li>
<li>continue from last example or open preprocessed file
<ul class="org-ul">
<li>file &gt; open &gt; [mri-stack-binary] (IJ:26.4)</li>
</ul></li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
for (currentStep=0; currentStep&lt;100;currentStep++){
  run("Next Slice [&gt;]");
  run("Measure");
}
</pre></li>
<li><b>Question:</b> what is the issue with this approach?</li>
</ol>
</div>
</div>

<div id="outline-container-orgcee3c93" class="outline-3">
<h3 id="orgcee3c93"><span class="section-number-3">9.4.</span> automatic iteration - introducing function for stop condition</h3>
<div class="outline-text-3" id="text-9-4">
<ol class="org-ol">
<li><b>target:</b> avoid fixed stop condition and exchange it by more
accurate mechanism</li>
<li>continue from last example or open preprocessed file
<ul class="org-ul">
<li>file &gt; open &gt; [mri-stack-binary] (IJ:26.4)</li>
</ul></li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
for (currentStep=1; currentStep&lt;=nSlices();currentStep++){
  setSlice(currentStep);
  run("Measure");
}
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org6152501" class="outline-3">
<h3 id="org6152501"><span class="section-number-3">9.5.</span> adding macro to the menu</h3>
<div class="outline-text-3" id="text-9-5">
<ol class="org-ol">
<li><b>target:</b> add macro to the menu</li>
<li>continue from last example or open preprocessed file
<ul class="org-ul">
<li>file &gt; open &gt; [mri-stack-binary] (IJ:26.4)</li>
</ul></li>
<li><p>
switch to code editor and make sure that the code looks in the
following way:
</p>
<pre class="example">
macro "measure stack" {
  for (currentStep=1; currentStep&lt;=nSlices();currentStep++){
    setSlice(currentStep);
    run("Measure");
  }
}
</pre></li>
<li>language &gt; ImageJ Macro</li>
<li>save &gt; .ijm</li>
<li>plugins &gt; macros &gt; install&#x2026; (IJ:31.1.1) 
<ul class="org-ul">
<li>select the macro you just saved</li>
</ul></li>
<li>(optional) test following FIJI tool
<ul class="org-ul">
<li>image &gt; stacks &gt; plot z axis profile (IJ:28.6.13)</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org82a8b23" class="outline-3">
<h3 id="org82a8b23"><span class="section-number-3">9.6.</span> iterations and variables in the macro: multi-measurement</h3>
<div class="outline-text-3" id="text-9-6">
<ol class="org-ol">
<li><b>target:</b> prepare the evenly distributed selection over the
image v.1 This can be used e.g. in FRAP experiment analysis.</li>
<li>open : [frap.tif] (IJ:26.2)</li>
<li><p>
test code:
</p>
<pre class="example">
// initialization
x = 20;
y = 20;

// iterations
for (nbr_x=0;nbr_x&lt;5;nbr_x++){
  for (nbr_y=0;nbr_y&lt;5;nbr_y++){
    makePoint(x+x*nbr_x, y+y*nbr_y);
    run("Enlarge...", "enlarge=5 pixel");
    roiManager("Add");
  }
}
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org85d88ae" class="outline-3">
<h3 id="org85d88ae"><span class="section-number-3">9.7.</span> automatic measurement and saving to a file</h3>
<div class="outline-text-3" id="text-9-7">
<ol class="org-ol">
<li><b>target:</b> prepare the evenly distributed selection over the image v.2</li>
<li><p>
test code:
</p>
<pre class="example">
// initialization
roiManager("reset");
x = 220;
y = 110;
nbr_sensors = 4;
delta = 12;

// iterations to create selection
for (nbr_x=0;nbr_x&lt;nbr_sensors;nbr_x++){
  for (nbr_y=0;nbr_y&lt;nbr_sensors;nbr_y++){
    makePoint(x+delta*nbr_x, y+delta*nbr_y);
    run("Enlarge...", "enlarge=5 pixel");
    roiManager("Add");
  }
}

// measurement and save results
roiManager("Multi Measure");
fn = getInfo("image.filename");
saveAs("Results", "/Users/sstoma/Desktop/Results-"+ fn +".txt");
// exchange previous line with your path
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org80b188c" class="outline-3">
<h3 id="org80b188c"><span class="section-number-3">9.8.</span> user input via GUI</h3>
<div class="outline-text-3" id="text-9-8">
<ol class="org-ol">
<li><b>target:</b> prepare the evenly distributed selection over the image v.3</li>
<li><p>
test code:
</p>
<pre class="example">
// initialization
roiManager("reset");
x = 20;
y = 20;
nbr_sensors = 4;
delta = 12;

// GUI
Dialog.create("Please specify parameters:");
Dialog.addNumber("Size [px]: ", 5);
Dialog.show();
size = Dialog.getNumber();

// iterations to create selection
for (nbr_x=0;nbr_x&lt;nbr_sensors;nbr_x++){
  for (nbr_y=0;nbr_y&lt;nbr_sensors;nbr_y++){
    makePoint(x+delta*nbr_x, y+delta*nbr_y);
    run("Enlarge...", "enlarge="+ size +" pixel");
    roiManager("Add");
  }
}

// measurement and save results
roiManager("Multi Measure");
fn = getInfo("image.filename");
saveAs("Results", "/Users/sstoma/Desktop/Results-"+ fn +".txt");
// exchange previous line with your path
</pre></li>
</ol>
</div>
</div>
<div id="outline-container-org45547ae" class="outline-3">
<h3 id="org45547ae"><span class="section-number-3">9.9.</span> user input via image window / selection</h3>
<div class="outline-text-3" id="text-9-9">
<ol class="org-ol">
<li><b>target:</b> prepare the evenly distributed selection over the
image - add user selected zone of selection and prepare it to
work in the batch mode v.4</li>
<li><p>
test code:
</p>
<pre class="example">
// initialization
roiManager("reset");
x = 20;
y = 20;
nbr_sensors = 4;
delta = 12;

// GUI
Dialog.create("Please specify parameters:");
Dialog.addNumber("Size [px]: ", 5);
Dialog.show();
size = Dialog.getNumber();

// get the input for location from the image
setBatchMode("show");
waitForUser("Draw ROI, then hit OK"); 
getBoundingRect(x, y, width, height)

// iterations to create selection
for (nbr_x=0;nbr_x&lt;nbr_sensors;nbr_x++){
  for (nbr_y=0;nbr_y&lt;nbr_sensors;nbr_y++){
    makePoint(x+delta*nbr_x, y+delta*nbr_y);
    run("Enlarge...", "enlarge="+ size +" pixel");
    roiManager("Add");
  }
}

// measurement and save results
roiManager("Multi Measure");
fn = getInfo("image.filename");
saveAs("Results", "/Users/sstoma/Desktop/Results-"+ fn +".txt");
// exchange previous line with your path
</pre></li>
</ol>
</div>
</div>
<div id="outline-container-orgbc9d3ef" class="outline-3">
<h3 id="orgbc9d3ef"><span class="section-number-3">9.10.</span> batch mode - basics</h3>
<div class="outline-text-3" id="text-9-10">
<ol class="org-ol">
<li><b>target:</b> Create a macro to segment nuclei in a single
frame. Your macro should input a row to the Results containing
area for each nuclei in the image. Process all files in the hela
folder.</li>
<li>open : [hela/hela-1.tif] (IJ:26.2)</li>
<li>plugins &gt; macro &gt; recorder (IJ:31.1.4)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>select: triangle</li>
<li>check: dark background</li>
</ul></li>
<li>analyze &gt; analyze particles  (IJ:30.2)</li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
// processing
run("Gaussian Blur...", "sigma=2 stack");
setAutoThreshold("Triangle dark");
run("Convert to Mask");
run("Set Measurements...", "area mean display redirect=None decimal=9");
run("Analyze Particles...", "show=[Overlay Masks] display exclude");
</pre></li>
<li>process &gt; batch &gt; macro
<ul class="org-ul">
<li>input: select folder containing [hela-1.tif]-[hela-4.tif]</li>
<li>output: select folder out in the folder containing [hela-1.tif]-[hela-4.tif]</li>
</ul></li>
<li>click process</li>
<li><p>
modify to save results
</p>
<pre class="example">
// initialization
outPath = "/Users/sstoma/Desktop/materials/images/hela/out/"; 
// exchange previous line with your path

// processing
run("Gaussian Blur...", "sigma=2 stack");
setAutoThreshold("Triangle dark");
run("Convert to Mask");
run("Set Measurements...", "area mean display redirect=None decimal=9");
run("Analyze Particles...", "show=[Overlay Masks] display exclude");

// saving
saveAs("Results", outPath+"Results.txt");
</pre></li>
<li><p>
modify the code (<b>target:</b> save each result in separated file):
</p>
<pre class="example">
// initilization
fileName = getInfo("image.filename");
outPath = "/Users/sstoma/Desktop/materials/images/hela/out/"; 
// exchange previous line with your path

// Process all images finishing with .tif 
dir = getDirectory("Choose a Directory where the HeLa tif files are");
dirresults = getDirectory("Choose a Directory where to save results (segmentations)");
list = getFileList(dir);

for (imagenumber=0;imagenumber&lt;list.length;imagenumber++)
{
  if (endsWith(list[imagenumber],".tif")){
    open(dir+list[imagenumber]); 
    run("Clear Results");
    // processing
    run("Gaussian Blur...", "sigma=2 stack");
    setAutoThreshold("Triangle dark");
    run("Convert to Mask");
    run("Set Measurements...", "area mean display redirect=None decimal=9");
    run("Analyze Particles...", "show=[Overlay Masks] display exclude");

    // saving
    saveAs("Results", outPath + "Results-" + fileName + ".txt");
  }
}
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org3acfa62" class="outline-3">
<h3 id="org3acfa62"><span class="section-number-3">9.11.</span> batch mode - full control on processing files</h3>
<div class="outline-text-3" id="text-9-11">
<ol class="org-ol">
<li><b>target:</b> Create a macro to segment nuclei in a single
frame. Your macro should input a row to the Results containing
area for each nuclei in the image. Process all files in the hela
folder. Do not use the batch execution in FIJI - iterate on
files in the folder instead.</li>
<li>open : [hela/hela-1.tif] (IJ:26.2)</li>
<li>plugins &gt; macro &gt; recorder (IJ:31.1.4)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ul class="org-ul">
<li>select: triangle</li>
<li>check: dark background</li>
</ul></li>
<li>analyze &gt; analyze particles  (IJ:30.2)</li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
// Process all images finishing with .tif 
dir = getDirectory("Choose a Directory where the HeLa tif files are");
outPath = getDirectory("Choose a Directory where to save results (segmentations)");
list = getFileList(dir);

// in list elements are numbered from 0
for (imagenumber=0;imagenumber&lt;list.length;imagenumber++)
{
  if (endsWith(list[imagenumber],".tif")){
    open(dir+list[imagenumber]); 
    run("Clear Results");
    // processing
    run("Gaussian Blur...", "sigma=2 stack");
    setAutoThreshold("Triangle dark");
    run("Convert to Mask");
    run("Set Measurements...", "area mean display redirect=None decimal=9");
    run("Analyze Particles...", "show=[Overlay Masks] display exclude");

    // saving
vfileName = getInfo("image.filename");
    saveAs("Results", outPath + "Results-" + fileName + ".txt");
  }
}
</pre></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org8af8c38" class="outline-2">
<h2 id="org8af8c38"><span class="section-number-2">10.</span> workflow: tracking</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-org7835065" class="outline-3">
<h3 id="org7835065"><span class="section-number-3">10.1.</span> create image with moving dots</h3>
<div class="outline-text-3" id="text-10-1">
<ol class="org-ol">
<li><b>target:</b> create an image with moving objects (dots)</li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
macro "create_image_with_moving_objects"{
  // initial variables
  nbr_frames = 40; // number of frames in the image
  color1 = 150; // color of first obj.
  color2 = 250; // color of sec. obj.
  canvas_size = 200; // size of the image
  step = 4; // progress in x between frames
  delta = 15; // difference in position between two objects in x
  x = 5; // initial position x of object
  y = 5;  // initial position y of object
  width = 10; // baseline size of object in x
  height = 10; // baseline size of object in y

  // empty image with noise
  newImage("Image", "8-bit black", canvas_size, canvas_size, nbr_frames); // image will be named "Image"
  run("Salt and Pepper", "stack");

  for(i=1;i&lt;=nbr_frames;i++){
    setSlice(i);
    // first dot
    setColor(color1,color1,color1);
    fillOval(x+i*step, y+i*step, width, height);
    // second dot
    setColor(color2,color2,color2);
    fillOval(delta+x+i*step, canvas_size-(y+i*step), width*2, height*2);
  }
  run("glasbey");
}
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org9c521ac" class="outline-3">
<h3 id="org9c521ac"><span class="section-number-3">10.2.</span> tracking: process single image</h3>
<div class="outline-text-3" id="text-10-2">
<ol class="org-ol">
<li><b>target:</b> for <b>current</b> frame of the stack find the x, y of the
center of the dot</li>
<li><p>
make sure that the code looks in the following way
</p>
<pre class="example" id="org473c83f">
macro "tracking_process_single_image"{
  run("Median...", "radius=2 slice");
  setThreshold(0, 100);
  run("Convert to Mask", "method=Otsu background=Light only");
  run("glasbey");
  run("Find Maxima...", "noise=25 output=List light");
}
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org3f49755" class="outline-3">
<h3 id="org3f49755"><span class="section-number-3">10.3.</span> tracking: process whole stack</h3>
<div class="outline-text-3" id="text-10-3">
<ol class="org-ol">
<li><b>target:</b> for <b>all</b> frames of the stack find the x, y of the
center of the dot</li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
macro "tracking_process_stack_v1"{
  r = newArray();
  for (i=1;i&lt;=nSlices();i++){
    setSlice(i);
    run("Median...", "radius=2 slice");
    setThreshold(0, 100);
    run("Convert to Mask", "method=Otsu background=Light only");
    run("glasbey");
    run("Find Maxima...", "noise=25 output=List light");
    run("Next Slice [&gt;]");

  // workaround for Find maxima overwriting results at each step
    for (j=0;j&lt;nResults();j++){
      x = getResult("X", j);
      y = getResult("Y", j);
      print(x, y, i);
      temp = newArray(x, y);
      r = Array.concat(r, temp);
    }
  }
  Array.show( r );
}
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-orgc45a7b6" class="outline-3">
<h3 id="orgc45a7b6"><span class="section-number-3">10.4.</span> tracking: process whole stack - enabling linking of the objects</h3>
<div class="outline-text-3" id="text-10-4">
<ol class="org-ol">
<li><b>target:</b> for <b>all</b> frames of the stack find the x, y of the
center of the dot as well as some object features (i.e. size,
mean grey value).</li>
<li><p>
make sure that the code looks in the following way:
</p>
<pre class="example">
macro "tracking_process_stack_v2"{
  // clearing previous result and preparing image copy
  run("Clear Results"); 
  rename("Image");
  run("Duplicate...", "duplicate");
  rename("orig");
  selectWindow("Image");

  // iterating for each slice in the stack
  for (i=1;i&lt;=nSlices();i++){
    setSlice(i);
    run("Median...", "radius=2 slice"); // removing noise
    setThreshold(0, 100); // hardcoded thr. for image
    run("Convert to Mask", "method=Otsu background=Light only");
    run("glasbey"); // changing LUT to get false collors to better distinguish objects
    run("Set Measurements...", "area mean standard center median skewness area_fraction stack redirect=orig decimal=2");
    run("Analyze Particles...", "display slice");
    run("Next Slice [&gt;]");
  }
}
</pre></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgf179bfb" class="outline-2">
<h2 id="orgf179bfb"><span class="section-number-2">11.</span> workflow: FRET</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-org8cd43b5" class="outline-3">
<h3 id="org8cd43b5"><span class="section-number-3">11.1.</span> preparation part 1 - image import</h3>
<div class="outline-text-3" id="text-11-1">
<ol class="org-ol">
<li><b>target:</b> open .lif image and prepare it for further editing</li>
<li>file &gt; open : [FRET_biosensor.lif] (IJ:26.2)
<ul class="org-ul">
<li>configure the importer</li>
<li>disable: all series</li>
</ul></li>
<li>choose 3rd serie</li>
<li>image &gt; stacks &gt; z project (IJ:28.6.11)</li>
<li>image &gt; color &gt; split channel (IJ:28.5.1)</li>
<li>select blue channel (ch0) 
<ul class="org-ul">
<li>file &gt; save as &gt; tif : cfp.tif (IJ:26.10.1)</li>
</ul></li>
<li>select yellow channel (ch1) 
<ul class="org-ul">
<li>file &gt; save as &gt; tif : yfp.tif (IJ:26.10.1)</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org960a507" class="outline-3">
<h3 id="org960a507"><span class="section-number-3">11.2.</span> preparation part 2 - averaging</h3>
<div class="outline-text-3" id="text-11-2">
<ol class="org-ol">
<li><b>target:</b> prepare images for further editing</li>
<li>file &gt; open : [cfp.tif and yfp.tif] (IJ:26.2)</li>
<li>select blue channel (cfp.tif)
<ul class="org-ul">
<li>process &gt; filters &gt; gaussian blur % sigma ~= 2 (IJ:29.11.2)</li>
<li>file &gt; save as &gt; tif : cfp-smoothed.tif (IJ:26.10.1)</li>
</ul></li>
<li>select yellow channel (yfp.tif)
<ul class="org-ul">
<li>process &gt; filters &gt; gaussian blur % sigma ~= 2 (IJ:29.11.2)</li>
<li>file &gt; save as &gt; tif : yfp-smoothed.tif (IJ:26.10.1)</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org1c3915d" class="outline-3">
<h3 id="org1c3915d"><span class="section-number-3">11.3.</span> preparation part 3 - masks</h3>
<div class="outline-text-3" id="text-11-3">
<p>
<b>target:</b> prepare masks
</p>
<ol class="org-ol">
<li>file &gt; open : [yfp-smoothed.tif] (IJ:26.2)</li>
<li>image &gt; adjust &gt; threshold (IJ:28.2.4)
<ol class="org-ol">
<li>test different option to isolate chromatine</li>
</ol></li>
<li>file &gt; save as &gt; tif : mask.tif (IJ:26.10.1)</li>
</ol>
</div>
</div>

<div id="outline-container-orgf1a7371" class="outline-3">
<h3 id="orgf1a7371"><span class="section-number-3">11.4.</span> preparation part 4 - ratios</h3>
<div class="outline-text-3" id="text-11-4">
<p>
<b>target:</b> prepare image with ratios
</p>
<ol class="org-ol">
<li>file &gt; open : [cfp-smoothed.tif and yfp-smoothed.tif] (IJ:26.2)</li>
<li>process &gt; calculator plus &gt; divide (i1 = yfp, i2 = cfp, k1 = 1, k2 = 0)</li>
<li>file &gt; save as &gt; tif : ratio.tif (IJ:26.10.1)</li>
</ol>
</div>
</div>

<div id="outline-container-orgcc291f9" class="outline-3">
<h3 id="orgcc291f9"><span class="section-number-3">11.5.</span> analysis - problem: cell population</h3>
<div class="outline-text-3" id="text-11-5">
<p>
<b>target:</b> measure the change of signal in ratio.tif image
</p>
<ol class="org-ol">
<li>file &gt; open : [ratio.tif] (IJ:26.2)</li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: mean gray value / standard deviation</li>
</ul></li>
<li>analyze &gt; measure (m) (IJ:29.12.1)</li>
<li>move to next time point; repeat;&#x2026;</li>
<li>image &gt; stacks &gt; plot z axis profile (IJ:28.6.13)
<ul class="org-ul">
<li>if does not work: image &gt; hyperstacks &gt; re-order hyperstack
<ul class="org-ul">
<li>swap t with z</li>
</ul></li>
</ul></li>
<li>question:  what is the problem with results?</li>
</ol>
</div>
</div>

<div id="outline-container-org7724b42" class="outline-3">
<h3 id="org7724b42"><span class="section-number-3">11.6.</span> preparation part 5 - cropping</h3>
<div class="outline-text-3" id="text-11-6">
<p>
<b>target:</b> prepare image with ratios
</p>
<ol class="org-ol">
<li>file &gt; open : [all previously prepared images] (IJ:26.2)</li>
<li>choose a cell in transition to anaphase - make sure the field of view keeps only this cell during all time-points
<ul class="org-ul">
<li>[palette &gt; rectangular selection] (IJ:19.1)</li>
<li>edit &gt; selection &gt; add to manager (ctrl-t) (IJ:27.12.22)</li>
<li>use roi manager to move selection between images
<ul class="org-ul">
<li>analyze &gt; tools &gt; ROI manager</li>
</ul></li>
</ul></li>
<li>image &gt; crop (IJ:28.8)</li>
<li>save all files adding &ldquo;-crop&rdquo; postfix</li>
</ol>
</div>
</div>

<div id="outline-container-org8bdd96b" class="outline-3">
<h3 id="org8bdd96b"><span class="section-number-3">11.7.</span> analysis - problem: chromatin change</h3>
<div class="outline-text-3" id="text-11-7">
<p>
<b>target:</b> measure the change of signal in ratio-crop.tif image
</p>
<ol class="org-ol">
<li>file &gt; open : [ratio-crop.tif] (IJ:26.2)</li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: mean gray value / standard deviation</li>
</ul></li>
<li>analyze &gt; measure (m) (IJ:29.12.1)</li>
<li>move to next time point; repeat;&#x2026;</li>
<li>image &gt; stacks &gt; plot z axis profile (IJ:28.6.13)
<ul class="org-ul">
<li>if does not work: image &gt; hyperstacks &gt; re-order hyperstack
<ul class="org-ul">
<li>swap t with z</li>
</ul></li>
</ul></li>
<li>question: what are the issues with results?</li>
</ol>
</div>
</div>

<div id="outline-container-org0a2ab5b" class="outline-3">
<h3 id="org0a2ab5b"><span class="section-number-3">11.8.</span> analysis - problem: manual labor</h3>
<div class="outline-text-3" id="text-11-8">
<p>
<b>target:</b> measure the change of signal in ratio-crop.tif image limited
   to chromatin
</p>
<ol class="org-ol">
<li>file &gt; open : [mask-crop.tif] (IJ:26.2)</li>
<li>[palette &gt; wand selection] (IJ:19.7)
<ul class="org-ul">
<li>add chromatin from current time-point</li>
<li>edit &gt; selection &gt; add to manager (ctrl-t) (IJ:27.12.22)</li>
<li>move to next time-point</li>
<li>repeat</li>
</ul></li>
<li>file &gt; open : [ratio-crop.tif] (IJ:26.2)</li>
<li>analyze &gt; set measurements (IJ:30.7)
<ul class="org-ul">
<li>check: mean gray value / standard deviation</li>
</ul></li>
<li>select the right ROI; analyze &gt; measure (m) (IJ:29.12.1)</li>
<li>move to next time point; repeat;&#x2026;</li>
<li>question: what are the issues with results?</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orga8efc58" class="outline-2">
<h2 id="orga8efc58"><span class="section-number-2">12.</span> workflow: scratch assay</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-orgfd372ba" class="outline-3">
<h3 id="orgfd372ba"><span class="section-number-3">12.1.</span> part 1</h3>
<div class="outline-text-3" id="text-12-1">
<ol class="org-ol">
<li><b>target:</b> estimate the area occupied by cells in single timepoint</li>
<li>file &gt; open : [scratch/control-single-frame.tif] (IJ:26.2)</li>
<li>image &gt; duplicate</li>
<li>process &gt; filters &gt; gaussiab blur
<ol class="org-ol">
<li>sigma: 5</li>
</ol></li>
<li>threshold
<ol class="org-ol">
<li>Method: Moments</li>
<li>Background: Dark</li>
</ol></li>
<li>image &gt; invert</li>
<li>process &gt; binary &gt; Distance Map</li>
<li>threshold
<ol class="org-ol">
<li>Method: Moments</li>
<li>Background: Dark</li>
</ol></li>
<li>select original image</li>
<li>image &gt; type &gt; 8-bit</li>
<li>image &gt; color &gt; merge channels
<ol class="org-ol">
<li>C1: original image (after conversion to 8-bit)</li>
<li>C4: mask</li>
<li>Create composite: True</li>
<li>Keep source images: True</li>
</ol></li>
</ol>
</div>
</div>

<div id="outline-container-org4a2c380" class="outline-3">
<h3 id="org4a2c380"><span class="section-number-3">12.2.</span> part 2</h3>
<div class="outline-text-3" id="text-12-2">
<ol class="org-ol">
<li><b>target:</b> estimate the area occupied by cells in each time point
(extend part 1 and identify the main problem)</li>
<li>file &gt; open : [scratch/control.tif] (IJ:26.2)</li>
<li>repeat steps from part 1 on the stack</li>
</ol>
</div>
</div>

<div id="outline-container-org0500687" class="outline-3">
<h3 id="org0500687"><span class="section-number-3">12.3.</span> part 3</h3>
<div class="outline-text-3" id="text-12-3">
<ol class="org-ol">
<li><b>target:</b> estimate the area occupied by cells in each time point</li>
<li>file &gt; open : [scratch/control.tif] (IJ:26.2)</li>
<li>image &gt; duplicate</li>
<li>image &gt; process &gt; subtract background
<ol class="org-ol">
<li>Radius: 30</li>
<li>Preview: True</li>
</ol></li>
<li>process &gt; filters &gt; gaussiab blur
<ol class="org-ol">
<li>sigma: 5</li>
</ol></li>
<li>threshold
<ol class="org-ol">
<li>Method: Moments</li>
<li>Background: Dark</li>
</ol></li>
<li>image &gt; invert</li>
<li>process &gt; binary &gt; Distance Map</li>
<li>threshold
<ol class="org-ol">
<li>Method: Moments</li>
<li>Background: Dark</li>
</ol></li>
<li>select original image</li>
<li>image &gt; type &gt; 8-bit</li>
<li>image &gt; color &gt; merge channels
<ol class="org-ol">
<li>C1: original image (after conversion to 8-bit)</li>
<li>C4: mask</li>
<li>Create composite: True</li>
<li>Keep source images: True</li>
</ol></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org402ed38" class="outline-2">
<h2 id="org402ed38"><span class="section-number-2">13.</span> various useful tools</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-org469f4d6" class="outline-3">
<h3 id="org469f4d6"><span class="section-number-3">13.1.</span> installing plugins</h3>
<div class="outline-text-3" id="text-13-1">
<ol class="org-ol">
<li>download plugin from webpage:
<a href="http://bigwww.epfl.ch/algorithms/esnake/">http://bigwww.epfl.ch/algorithms/esnake/</a></li>
<li>unzip, drag and drop to FIJI</li>
<li>create new canvas</li>
<li>draw two white discs on black background</li>
<li>plugins &gt; ESnake
<ul class="org-ul">
<li>target brightness: bright</li>
</ul></li>
<li>click OK</li>
</ol>
</div>
</div>

<div id="outline-container-org5673f0e" class="outline-3">
<h3 id="org5673f0e"><span class="section-number-3">13.2.</span> using line selection to make a &ldquo;straighten&rdquo; image</h3>
<div class="outline-text-3" id="text-13-2">
<ol class="org-ol">
<li>file &gt; open samples &gt; nile bend (IJ:26.4)</li>
<li>use selection tool for freehand selection
<ul class="org-ul">
<li>make the line thickness adjusted to cover whole river</li>
</ul></li>
<li>edit &gt; selection &gt; straighten (IJ:27.12.17)</li>
</ol>
</div>
</div>

<div id="outline-container-org6489141" class="outline-3">
<h3 id="org6489141"><span class="section-number-3">13.3.</span> using 3D viewer</h3>
<div class="outline-text-3" id="text-13-3">
<ol class="org-ol">
<li>file &gt; open samples &gt; confocal series (IJ:26.4)</li>
<li>image &gt; properties &gt; voxel depth x10 % to get decent aspect ratio</li>
<li>plugins &gt; 3D viewer</li>
<li>add &gt; from image % the resampling factor is a downsampling factor</li>
<li>play with displayed colors</li>
<li>view &gt; start/stop animation</li>
<li>view &gt; change animation settings</li>
<li>view &gt; record 360 degree rotation</li>
<li>file &gt; save as &gt; avi % try the different compression options uncompressed, jpg, and png</li>
</ol>
</div>
</div>

<div id="outline-container-org3f0c713" class="outline-3">
<h3 id="org3f0c713"><span class="section-number-3">13.4.</span> preparing images for publications</h3>
<div class="outline-text-3" id="text-13-4">
<ul class="org-ul">
<li>FigureJ plugin:
<ul class="org-ul">
<li><a href="http://imagejdocu.tudor.lu/doku.php?id=plugin:utilities:figurej:start#installation_for_fiji">http://imagejdocu.tudor.lu/doku.php?id=plugin:utilities:figurej:start#installation_for_fiji</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Federico Gasparoli, Szymon Stoma Simon F. Nørrelykke</p>
<p class="email">Email: <a href="mailto:simon@hms.harvard.edu">simon@hms.harvard.edu</a></p>
<p class="date">Created: 2024-10-10 Thu 12:54</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
